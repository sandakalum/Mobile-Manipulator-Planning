<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ibs: src/ibs.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ibs
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ibs.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ibs_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// @file   : ibs.cpp</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// @brief  : Intelligent Board System</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// @author : Akio Shigekane, Yoonseok Pyo</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// @version: Ver1.1.1 (since 2012.00.00)</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// @date   : 2015.2.25</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;sstream&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;termios.h&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;ros/ros.h&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;tms_msg_db/tmsdb_data.h&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;tms_msg_ss/ics_object_data.h&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;tms_msg_db/TmsdbStamped.h&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;tms_msg_db/Tmsdb.h&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;boost/date_time/posix_time/posix_time.hpp&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a0fc8e8a97223a17e76478274643bb540">   39</a></span>&#160;std::string <a class="code" href="ibs_8cpp.html#a0fc8e8a97223a17e76478274643bb540">PORT_TR</a>, <a class="code" href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">   42</a></span>&#160;<span class="preprocessor">#define LC_MAX_SENSOR_NUM  4</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#aed2a39405aa5b4659703051182dc0ca4">   43</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define LC_GET_WEIGHT_CNT  2</span></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#af93bee80e57bd99ec2e98ca2f7d3fb6c">   44</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define LC_GET_WEIGHT_STABLE 12 //</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#aad394657151ae8a841b6e6831d7e77f2">   46</a></span>&#160;<span class="preprocessor">#define MAX_OBJECT_NUM      25      //環境内に存在する全物品数</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">//仕様上の固定値</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#ad533b42d0963430c62bdde2bdf42708d">   49</a></span>&#160;<span class="preprocessor">#define TR3_STX   0x02</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#ad99617d68d1009eed07e9da83c1ec14c">   50</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ETX   0x03</span></div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a10a93622ab558e891f3ace1c3ecd287a">   51</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_CR    0x0D</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a3a282a5ac1d89f541dc31058c5a3b562">   52</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ACK   0x30</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#afc3e35d9d6c6023c2912eee67b1d4594">   53</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_NACK  0x31</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a589ebccba2eb512cf203ce6bf15a2601">   54</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_UID_SEND   0x49</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a5046db214a2b64c17c55f2faef3d8caf">   56</a></span>&#160;<span class="preprocessor">#define TR3_ANT1   0x00</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#ac3ef5e3754b9a259c7f3f975de350a70">   57</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ANT2   0x01</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a187bccc71680670bb0e3216c650c108a">   58</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ANT3   0x02</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a0569675ceaff2d17dc98211b54c41ad3">   59</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ANT4   0x03</span></div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#ae8ebfc93ffa5302f9a7cdd557f7c6d38">   60</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ANT5   0x04</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a1f1ac0c131839c0abfe132ecbfe06b97">   61</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ANT6   0x05</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a84ed4d756814d7b095e511d25210cbb6">   62</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ANT7   0x06</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a24f79647c93559240436120a67d5fa11">   63</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ANT8   0x07</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a8bde56b97c65019adde6ebe8b46fe8ab">   65</a></span>&#160;<span class="preprocessor">#define TR3_ModeCommand   0x00</span></div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a63ea78938d991a7b6735d1f3ef1390a6">   66</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ModeAutoscan  0x01</span></div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a1420e2e6c54f45d66450f3977b178f24">   67</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ModeTriger    0x02</span></div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a7647dab994d1e7da77b21a3985b49f6b">   68</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ModePolling   0x03</span></div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#acd76d32485dc0fecb4c5d3f1cb517f86">   69</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ModeEAS       0x24</span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#ae3338c372c7c6e34baf2d76d4f612fd9">   70</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ModeInventory 0x50</span></div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#aea7995fa791d5a52f696cd52125b3647">   71</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_ModeRDLOOP    0x58</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a02ebfacfe01d06dac0d6a7990be1d6b3">   73</a></span>&#160;<span class="preprocessor">#define TR3_UID_SIZE  8</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a399d56edee80f7de024763ff25a9beef">   74</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_TAG_SIZE  16</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">//ユーザ設定値</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#ac6ec2b73b68bec0d6052f9acd2f4bdc6">   77</a></span>&#160;<span class="preprocessor">#define TR3_TAG_MAX  40 //HardwareMAX: 200</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a6b8656a2cda060e7ebdd0a3f52bd4a4e">   78</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_MAX_COMMAND_SIZE  30</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a3aedab4e7e4cd23376617272baaf39be">   79</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TR3_USED_ANT_NUM  2</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a79c06e69468a82bc5fe9f473108502ce">   81</a></span>&#160;<span class="preprocessor">#define IC_STAGE_NAME_SIZE  100</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a7c8e46c398bd4bed8ff336a68d76d72e">   82</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define IC_TAG_MAX  20</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a280b8ad925f5bb715f19cd118479a9b3">   83</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define IC_STAGES_MAX  2</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#af1cb23ac4ed0327d752bd7b7cd6fb4d4">   84</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define IC_OBJECT_IN     1</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#ae19a48cb6d01f24569002419c02523ee">   85</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define IC_OBJECT_OUT   -1</span></div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a027355753db6be51cd3fffa9f3f8018a">   86</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define IC_OBJECT_MOVE   2</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#ad60e12a8809faaef704ed8cec0be02ac">   87</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define IC_OBJECT_STAY   0</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a655c84af1b0034986ff56e12e84f983d">   89</a></span>&#160;<span class="preprocessor">#define NONE  0</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#ab77d8997b0680e0ffed72a9a1a9c8998">   90</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define EXIST 1</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a41b904cb066c95952a52cdef18efd703">   93</a></span>&#160;<span class="preprocessor">#define vec_str std::vector&lt;std::string&gt;</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a3fd67d6715f713a0232fbc9d3bdba655">   95</a></span>&#160;<span class="preprocessor">#define DEBUG_IBS 0</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#if     1 == DEBUG_IBS</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define D_COUT(x) do { std::cout &lt;&lt; x; } while (0)</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#else </span></div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a5a4ea210508f9ed64bb9a43207233cfb">   99</a></span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define D_COUT(x)</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="class_c_load_cell.html">  105</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_load_cell.html">CLoadCell</a> {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">  107</a></span>&#160;    <span class="keyword">struct </span>termios oldtio, <a class="code" href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">newtio</a>;  <span class="comment">/* 通信ポートを制御するためのインターフェイス */</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_load_cell.html#a0439c17ee38de185bd461305f1fb4cb8">Close</a>();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_c_load_cell.html#ad6fb880bd0b8752530177b6df9d6094e">OpenPort</a>();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_c_load_cell.html#a1b3857837a0bf6fd7bfb4944c4ac8c30">ClosePort</a>();</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a17f056971822e54aa60a07fb2ec5a9f9">  111</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_c_load_cell.html#a17f056971822e54aa60a07fb2ec5a9f9">mPreSensorsWeight</a>[<a class="code" href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">LC_MAX_SENSOR_NUM</a>];</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a68aad558e42bcfda8a0121b94e7b1eba">  112</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="class_c_load_cell.html#a68aad558e42bcfda8a0121b94e7b1eba">mSensorPosX</a>[<a class="code" href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">LC_MAX_SENSOR_NUM</a>];</div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a2aabc4a9a13f29fba6c0f2f73caaf0ef">  113</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="class_c_load_cell.html#a2aabc4a9a13f29fba6c0f2f73caaf0ef">mSensorPosY</a>[<a class="code" href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">LC_MAX_SENSOR_NUM</a>];</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a58a5404e2ec0d122630c14ff5b69696a">  116</a></span>&#160;    <a class="code" href="class_c_load_cell.html#a58a5404e2ec0d122630c14ff5b69696a">CLoadCell</a>() {};</div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a2974d37c5af7a2e9636f52cce2030afe">  117</a></span>&#160;    <a class="code" href="class_c_load_cell.html#a2974d37c5af7a2e9636f52cce2030afe">~CLoadCell</a>() {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="class_c_load_cell.html#a0439c17ee38de185bd461305f1fb4cb8">Close</a>(); };</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_load_cell.html#aed02b108d6edd17adc845a0d86fa0871">Setup</a>();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">  121</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_c_load_cell.html#ac7dda0d98c1af1df1062a4315c83c0d5">ResetWeight</a>(<span class="keywordtype">int</span> initial[] = NULL, <span class="keywordtype">int</span> num = 10);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_c_load_cell.html#ab9d1d0beef3b47823788f2350ee4db52">SetSensorPos</a>(<span class="keywordtype">int</span> sensor_num, <span class="keywordtype">float</span> x[], <span class="keywordtype">float</span> y[]);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_c_load_cell.html#a33b28a515fc435aee4bc6b121fc479a8">GetWeight</a>(<span class="keywordtype">int</span> sensor_id);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_c_load_cell.html#a4548e87aa05684bef7ab9b6a6e4f5908">GetWeightDiff</a>(<span class="keywordtype">float</span> *x, <span class="keywordtype">float</span> *y, <span class="keywordtype">int</span> diffs[], <span class="keywordtype">int</span> threshold = 20);</div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">  126</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">fd</a>; };</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="class_c_t_r3.html">  129</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_t_r3.html">CTR3</a> {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#a15985a0b2c48c7d44edac27950d39d40">  131</a></span>&#160;    <span class="keyword">struct </span>termios oldtio, <a class="code" href="class_c_t_r3.html#a15985a0b2c48c7d44edac27950d39d40">newtio</a>;  <span class="comment">/* 通信ポートを制御するためのインターフェイス */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_t_r3.html#a06c585509be4908cc4b5ee28b9f8cb95">Close</a>();</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_c_t_r3.html#af8cad3d03c19a9ef74159be963ffbe0a">OpenPort</a>();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_c_t_r3.html#a0c96690422fcbaa57ad0c43569023b84">ClosePort</a>();</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">  135</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[<a class="code" href="ibs_8cpp.html#a6b8656a2cda060e7ebdd0a3f52bd4a4e">TR3_MAX_COMMAND_SIZE</a>];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordtype">int</span>  <a class="code" href="class_c_t_r3.html#aac759784c783b44b374c9d9a3884e11b">AddChecksum</a>();</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">  137</a></span>&#160;    <span class="keywordtype">int</span>  <a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>;  </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">int</span>  <a class="code" href="class_c_t_r3.html#adbd50e4143b3e344d3d5502043bf2a10">Inventory2</a>();</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#aba12596e98594fc1c342cbc6adcc9018">  140</a></span>&#160;    <a class="code" href="class_c_t_r3.html#aba12596e98594fc1c342cbc6adcc9018">CTR3</a>() {};</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#ae2dd0ddf15683ae5e8274ba64b976456">  141</a></span>&#160;    <a class="code" href="class_c_t_r3.html#ae2dd0ddf15683ae5e8274ba64b976456">~CTR3</a>() {</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">  142</a></span>&#160;        <a class="code" href="class_c_t_r3.html#a06c585509be4908cc4b5ee28b9f8cb95">Close</a>(); };</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="ibs_8cpp.html#a41b904cb066c95952a52cdef18efd703">vec_str</a> <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="ibs_8cpp.html#a3aedab4e7e4cd23376617272baaf39be">TR3_USED_ANT_NUM</a>];    </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_t_r3.html#aad0fa8aaed9250f6244160e846e295ca">Setup</a>();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">int</span>  <a class="code" href="class_c_t_r3.html#ad76ae24fee078e665d6b4762b21d9098">SetAntenna</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> AN = <a class="code" href="ibs_8cpp.html#a5046db214a2b64c17c55f2faef3d8caf">TR3_ANT1</a>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_t_r3.html#ae6aef26696f25ef915c6821b6ada40b0">AntennaPowerON</a>();</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_t_r3.html#a890606f65ef7913494ae41c6aabd5fd4">AntennaPowerOFF</a>();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_c_t_r3.html#a6fa902a1dcfba84c4d702bbc69253b53">PrintTagUIDs</a>();</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordtype">int</span>  <a class="code" href="class_c_t_r3.html#ab5e4f0b07c3a4bc37891f1de4b9f809d">GetTagDiff</a>(std::string &amp;diffUID, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> AN);</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">  152</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>; };</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html">  155</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_tag_o_b_j.html">CTagOBJ</a> {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_tag_o_b_j.html#a7f63e0b50de6dea88308f9d52f2fc726">Setup</a>();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_tag_o_b_j.html#a253025c5b5603be2af238f3bda5b1bb4">Close</a>();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html#a5d16d573544e0d931afbfcb8e8e13e5f">  161</a></span>&#160;    <a class="code" href="class_c_tag_o_b_j.html#a5d16d573544e0d931afbfcb8e8e13e5f">CTagOBJ</a>() {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <a class="code" href="class_c_tag_o_b_j.html#a7f63e0b50de6dea88308f9d52f2fc726">Setup</a>(); };</div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html#a239a9c11e4163e0b462097b20dc23784">  163</a></span>&#160;    <a class="code" href="class_c_tag_o_b_j.html#a239a9c11e4163e0b462097b20dc23784">~CTagOBJ</a>() {</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">  164</a></span>&#160;        <a class="code" href="class_c_tag_o_b_j.html#a253025c5b5603be2af238f3bda5b1bb4">Close</a>(); };</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    std::string <a class="code" href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">mUID</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html#a686315632804b3a7e78414ff68fc4872">  167</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_c_tag_o_b_j.html#a686315632804b3a7e78414ff68fc4872">mWeight</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html#a981dc794723b7d840d7a7197cede5b60">  168</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_c_tag_o_b_j.html#a981dc794723b7d840d7a7197cede5b60">mDiffs</a>[<a class="code" href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">LC_MAX_SENSOR_NUM</a>];</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html#a72cf7b86cc7a011d924664a4eb1d0c35">  169</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="class_c_tag_o_b_j.html#a72cf7b86cc7a011d924664a4eb1d0c35">mX</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html#a863247a8d2fc31ae25e3ff5d035a6c9a">  170</a></span>&#160;    <span class="keywordtype">float</span> <a class="code" href="class_c_tag_o_b_j.html#a863247a8d2fc31ae25e3ff5d035a6c9a">mY</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html#a864b70701ce07ed4a9da0ba61e25f952">  171</a></span>&#160;    std::string  <a class="code" href="class_c_tag_o_b_j.html#a864b70701ce07ed4a9da0ba61e25f952">mName</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html#a48cb35c9dd1d47cc63a149ac18782ddb">  172</a></span>&#160;    std::string  <a class="code" href="class_c_tag_o_b_j.html#a48cb35c9dd1d47cc63a149ac18782ddb">mComment</a>;};</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="class_c_stage.html">  175</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_stage.html">CStage</a> {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_stage.html#af8bb32d272a922b7f0c1afe8c5bcc57c">Close</a>();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="class_c_stage.html#a0227696f11c44a0ea28c769cdfc90639">  180</a></span>&#160;    <a class="code" href="class_c_stage.html#a0227696f11c44a0ea28c769cdfc90639">CStage</a>() {};</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="class_c_load_cell.html">CLoadCell</a> <a class="code" href="class_c_stage.html#a257bbfe84f165ddd017277ae971791de">cLoadCell</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="class_c_stage.html#a1e1bfd7423a2f6a55e3c923b2cc06d4d">  182</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="class_c_stage.html#a1e1bfd7423a2f6a55e3c923b2cc06d4d">mAntenna</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="class_c_stage.html#ab9c62fdbf228acade7a75788f28f7e17">  183</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_c_stage.html#ab9c62fdbf228acade7a75788f28f7e17">mStagePos</a>[3];</div>
<div class="line"><a name="l00184"></a><span class="lineno"><a class="line" href="class_c_stage.html#ab58408c8c73b0c39c09990acc33c0d9a">  184</a></span>&#160;    std::string <a class="code" href="class_c_stage.html#ab58408c8c73b0c39c09990acc33c0d9a">mName</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="line" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">  185</a></span>&#160;    std::vector&lt;CTagOBJ&gt; <a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_stage.html#a3a2ea0f98635ec14875cbbe1ccb5d89e">Setup</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_c_stage.html#aa772cbfe279e9029f7eb4fbe6fa6689b">SetSensorPos</a>(<span class="keywordtype">int</span> sensor_num, <span class="keywordtype">float</span> x[], <span class="keywordtype">float</span> y[]);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_c_stage.html#aa3430025ec08870ccf3abc0c0d9517c6">SetAntenna</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> AN);};</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="class_c_intel_cab.html">  192</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_c_intel_cab.html">CIntelCab</a> {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_intel_cab.html#a6ef901d93959ac2b4c6ff320863f8d8a">Setup</a>(<span class="keywordtype">int</span> stage_num);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="class_c_intel_cab.html#a5560e4ecb9223b1031e35c3b9b2c5000">Close</a>();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="class_c_intel_cab.html#ae8ad3b41d4419f203a817148b80bcdf2">  198</a></span>&#160;    <a class="code" href="class_c_intel_cab.html#ae8ad3b41d4419f203a817148b80bcdf2">CIntelCab</a>(<span class="keywordtype">int</span> stage_num = <a class="code" href="ibs_8cpp.html#a280b8ad925f5bb715f19cd118479a9b3">IC_STAGES_MAX</a>) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="class_c_intel_cab.html#a6ef901d93959ac2b4c6ff320863f8d8a">Setup</a>(stage_num); };</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="class_c_intel_cab.html#a43734db8b7e89c0b4c78478ebfd618a1">  200</a></span>&#160;    <a class="code" href="class_c_intel_cab.html#a43734db8b7e89c0b4c78478ebfd618a1">~CIntelCab</a>() {</div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="class_c_intel_cab.html#a30dcf7e509a45a3f71bc1ba88ea6e0e3">  201</a></span>&#160;        <a class="code" href="class_c_intel_cab.html#a5560e4ecb9223b1031e35c3b9b2c5000">Close</a>(); };</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <a class="code" href="class_c_t_r3.html">CTR3</a> <a class="code" href="class_c_intel_cab.html#a30dcf7e509a45a3f71bc1ba88ea6e0e3">cTR3</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">  203</a></span>&#160;    <a class="code" href="class_c_stage.html">CStage</a> <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[<a class="code" href="ibs_8cpp.html#a280b8ad925f5bb715f19cd118479a9b3">IC_STAGES_MAX</a>];</div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="class_c_intel_cab.html#a3ead3daadede0387684f1afa68c65148">  204</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_c_intel_cab.html#a3ead3daadede0387684f1afa68c65148">mStageNum</a>;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_c_intel_cab.html#aadc0b97ecc3065d8821657e62055ac08">PrintObjInfo</a>();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="class_c_intel_cab.html#ac447a91375cc34f3fa40ea5868769904">UpdateObj</a>(<span class="keywordtype">int</span> stageNo, <a class="code" href="class_c_tag_o_b_j.html">CTagOBJ</a> *cInOut);};</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#aed02b108d6edd17adc845a0d86fa0871">  210</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_load_cell.html#aed02b108d6edd17adc845a0d86fa0871">CLoadCell::Setup</a>() {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">//数値初期化関連</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">LC_MAX_SENSOR_NUM</a>; i++) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <a class="code" href="class_c_load_cell.html#a17f056971822e54aa60a07fb2ec5a9f9">mPreSensorsWeight</a>[i] = 0;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <a class="code" href="class_c_load_cell.html#a68aad558e42bcfda8a0121b94e7b1eba">mSensorPosX</a>[i] = 0;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="class_c_load_cell.html#a2aabc4a9a13f29fba6c0f2f73caaf0ef">mSensorPosY</a>[i] = 0; }</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a> = <a class="code" href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">LC_MAX_SENSOR_NUM</a>;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;OPENING: LoadCell(port:&quot;</span> &lt;&lt; <a class="code" href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a>.c_str() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="class_c_load_cell.html#ad6fb880bd0b8752530177b6df9d6094e">OpenPort</a>();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;OPENED: LoadCell(port:&quot;</span> &lt;&lt; <a class="code" href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a>.c_str() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="class_c_load_cell.html#a1b3857837a0bf6fd7bfb4944c4ac8c30">ClosePort</a>();</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;CLOSED: LoadCell(port:&quot;</span> &lt;&lt; <a class="code" href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a>.c_str() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="class_c_load_cell.html#ac7dda0d98c1af1df1062a4315c83c0d5">ResetWeight</a>();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a0439c17ee38de185bd461305f1fb4cb8">  226</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_load_cell.html#a0439c17ee38de185bd461305f1fb4cb8">CLoadCell::Close</a>() {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    close(<a class="code" href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">fd</a>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;CLOSED: LoadCell&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#ad6fb880bd0b8752530177b6df9d6094e">  232</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_load_cell.html#ad6fb880bd0b8752530177b6df9d6094e">CLoadCell::OpenPort</a>(){ </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">//通信関連初期化</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="ibs_8cpp.html#a5a4ea210508f9ed64bb9a43207233cfb">D_COUT</a>(<span class="stringliteral">&quot;opening port : &quot;</span> &lt;&lt; <a class="code" href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a> &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">fd</a> = open(<a class="code" href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a>.c_str(), (O_RDWR | O_NOCTTY) )) &lt; 0 ) {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        printf(<span class="stringliteral">&quot;FAILED: LoadCell-&gt;OpenComPort:PORT_LC0 \n&quot;</span>);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        exit(-1); }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <a class="code" href="ibs_8cpp.html#a5a4ea210508f9ed64bb9a43207233cfb">D_COUT</a>(<span class="stringliteral">&quot;\033[1K\r&quot;</span>); </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    tcgetattr(<a class="code" href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">fd</a>, &amp;oldtio);         <span class="comment">/* 現在のシリアルポートの設定を待避させる*/</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    memset(&amp;<a class="code" href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">newtio</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">newtio</a>));</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">newtio</a>.c_cflag = B115200 | CS8 | CLOCAL | CREAD;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">newtio</a>.c_iflag = IGNPAR;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">newtio</a>.c_oflag = 0;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">newtio</a>.c_lflag = 0;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">newtio</a>.c_cc[VTIME] = 0;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">newtio</a>.c_cc[VMIN] = 15;            <span class="comment">/* 15文字受け取るまでブロックする */</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    tcflush(<a class="code" href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">fd</a>, TCIFLUSH);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    tcsetattr(<a class="code" href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">fd</a>, TCSANOW, &amp;<a class="code" href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">newtio</a>);}</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a1b3857837a0bf6fd7bfb4944c4ac8c30">  250</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_load_cell.html#a1b3857837a0bf6fd7bfb4944c4ac8c30">CLoadCell::ClosePort</a>(){</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    tcsetattr(<a class="code" href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">fd</a>, TCSANOW, &amp;oldtio);  <span class="comment">/* 退避させた設定に戻す */</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="ibs_8cpp.html#a5a4ea210508f9ed64bb9a43207233cfb">D_COUT</a>(<span class="stringliteral">&quot;closing port : &quot;</span> &lt;&lt; <a class="code" href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a> &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    close(<a class="code" href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">fd</a>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="ibs_8cpp.html#a5a4ea210508f9ed64bb9a43207233cfb">D_COUT</a>(<span class="stringliteral">&quot;\033[1K\r&quot;</span>); </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#ab9d1d0beef3b47823788f2350ee4db52">  258</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_load_cell.html#ab9d1d0beef3b47823788f2350ee4db52">CLoadCell::SetSensorPos</a>(<span class="keywordtype">int</span> sensor_num, <span class="keywordtype">float</span> x[], <span class="keywordtype">float</span> y[]) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a> = sensor_num;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; i++) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="class_c_load_cell.html#a68aad558e42bcfda8a0121b94e7b1eba">mSensorPosX</a>[i] = x[i];</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <a class="code" href="class_c_load_cell.html#a2aabc4a9a13f29fba6c0f2f73caaf0ef">mSensorPosY</a>[i] = y[i]; } }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">// 指定されたセンサから重さを取得する</span></div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a33b28a515fc435aee4bc6b121fc479a8">  266</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_c_load_cell.html#a33b28a515fc435aee4bc6b121fc479a8">CLoadCell::GetWeight</a>(<span class="keywordtype">int</span> sensor_id) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keywordtype">char</span> signal, buf[20];</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    memset(&amp;buf, 0, <span class="keyword">sizeof</span>(buf));</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// センサ番号からセンサのアドレスを求める</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> (0 &lt;= sensor_id &amp;&amp; sensor_id &lt;= 9)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        signal = sensor_id + <span class="charliteral">&#39;0&#39;</span>; <span class="comment">// 0-&gt;&#39;0&#39;, 1-&gt;&#39;1&#39;, ..., 9-&gt;&#39;9&#39;</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        signal = sensor_id - 10 + <span class="charliteral">&#39;A&#39;</span>; <span class="comment">// 10-&gt;&#39;A&#39;, 11-&gt;&#39;B&#39;, ... , 35-&gt;&#39;Z&#39;</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="class_c_load_cell.html#ad6fb880bd0b8752530177b6df9d6094e">OpenPort</a>();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    write(<a class="code" href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">fd</a>, &amp;signal, 1);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    read(<a class="code" href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">fd</a>, buf, 15);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="class_c_load_cell.html#a1b3857837a0bf6fd7bfb4944c4ac8c30">ClosePort</a>();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">int</span> output_value = atoi(buf);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// センサ出力を校正して返す</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(output_value * 5); <span class="comment">//0.28は経験的な値</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#ac7dda0d98c1af1df1062a4315c83c0d5">  284</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_load_cell.html#ac7dda0d98c1af1df1062a4315c83c0d5">CLoadCell::ResetWeight</a>(<span class="keywordtype">int</span> initial[], <span class="keywordtype">int</span> num) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (initial != NULL) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; i++)</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <a class="code" href="class_c_load_cell.html#a17f056971822e54aa60a07fb2ec5a9f9">mPreSensorsWeight</a>[i] = initial[i];</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; i++)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <a class="code" href="class_c_load_cell.html#a17f056971822e54aa60a07fb2ec5a9f9">mPreSensorsWeight</a>[i] = 0;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; num; i++)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; j++)</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <a class="code" href="class_c_load_cell.html#a17f056971822e54aa60a07fb2ec5a9f9">mPreSensorsWeight</a>[j] += <a class="code" href="class_c_load_cell.html#a33b28a515fc435aee4bc6b121fc479a8">GetWeight</a>(j);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; i++)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <a class="code" href="class_c_load_cell.html#a17f056971822e54aa60a07fb2ec5a9f9">mPreSensorsWeight</a>[i] /= num; }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">//重量の増減（物体の増減）があるかをチェック</span></div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="line" href="class_c_load_cell.html#a4548e87aa05684bef7ab9b6a6e4f5908">  304</a></span>&#160;<span class="keywordtype">int</span>  <a class="code" href="class_c_load_cell.html#a4548e87aa05684bef7ab9b6a6e4f5908">CLoadCell::GetWeightDiff</a>(<span class="keywordtype">float</span> *x, <span class="keywordtype">float</span> *y, <span class="keywordtype">int</span> diffs[], <span class="keywordtype">int</span> threshold) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> i, j, cnt, weight;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> now, pre[<a class="code" href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">LC_MAX_SENSOR_NUM</a>], buf[<a class="code" href="ibs_8cpp.html#aed2a39405aa5b4659703051182dc0ca4">LC_GET_WEIGHT_CNT</a>][<a class="code" href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">LC_MAX_SENSOR_NUM</a>];<span class="comment">//, latest[LC_MAX_SENSOR_NUM];</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">//出力が安定するまで待つ</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; i++) {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        pre[i] = <a class="code" href="class_c_load_cell.html#a33b28a515fc435aee4bc6b121fc479a8">GetWeight</a>(i); }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    cnt = 0;    <span class="comment">//繰り返し回数</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">/*------------------------------------------*/</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">//usleep(4000); //4ms程度は間隔を空ける</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        usleep(20000);  <span class="comment">//for demo</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        weight = 0;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; i++) {</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            now = <a class="code" href="class_c_load_cell.html#a33b28a515fc435aee4bc6b121fc479a8">GetWeight</a>(i);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            weight += abs(now - pre[i]);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            pre[i] = now;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            buf[cnt][i] = now; }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">if</span> (weight &lt; <a class="code" href="ibs_8cpp.html#af93bee80e57bd99ec2e98ca2f7d3fb6c">LC_GET_WEIGHT_STABLE</a>) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            cnt++; }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            cnt = 0; } }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">while</span> (cnt &lt; <a class="code" href="ibs_8cpp.html#aed2a39405aa5b4659703051182dc0ca4">LC_GET_WEIGHT_CNT</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">/*------------------------------------------*/</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">//出力</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; i++) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        pre[i] = 0; }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="ibs_8cpp.html#aed2a39405aa5b4659703051182dc0ca4">LC_GET_WEIGHT_CNT</a>; i++) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; j++) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            pre[j] += buf[i][j]; } }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; i++) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        pre[i] /= <a class="code" href="ibs_8cpp.html#aed2a39405aa5b4659703051182dc0ca4">LC_GET_WEIGHT_CNT</a>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        diffs[i] = pre[i] - <a class="code" href="class_c_load_cell.html#a17f056971822e54aa60a07fb2ec5a9f9">mPreSensorsWeight</a>[i]; }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    *x = *y = 0;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    weight = 0;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; i++) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        *x += (float)(<a class="code" href="class_c_load_cell.html#a68aad558e42bcfda8a0121b94e7b1eba">mSensorPosX</a>[i] * abs(diffs[i]));</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        *y += (float)(<a class="code" href="class_c_load_cell.html#a2aabc4a9a13f29fba6c0f2f73caaf0ef">mSensorPosY</a>[i] * abs(diffs[i]));</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        weight += diffs[i]; }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    *x /= abs(weight);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    *y /= abs(weight);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">if</span> (abs(weight) &lt; threshold) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">mSensorNum</a>; i++) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <a class="code" href="class_c_load_cell.html#a17f056971822e54aa60a07fb2ec5a9f9">mPreSensorsWeight</a>[i] = pre[i]; }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">return</span> weight; } }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#aad0fa8aaed9250f6244160e846e295ca">  357</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_t_r3.html#aad0fa8aaed9250f6244160e846e295ca">CTR3::Setup</a>() {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">//数値初期化関連</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a> = <a class="code" href="ibs_8cpp.html#a5046db214a2b64c17c55f2faef3d8caf">TR3_ANT1</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[0] = <a class="code" href="ibs_8cpp.html#ad533b42d0963430c62bdde2bdf42708d">TR3_STX</a>;  <span class="comment">//</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[1] = 0x00;     <span class="comment">//アドレス</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;OPENING: TR3(port:&quot;</span> &lt;&lt; <a class="code" href="ibs_8cpp.html#a0fc8e8a97223a17e76478274643bb540">PORT_TR</a>.c_str() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="class_c_t_r3.html#af8cad3d03c19a9ef74159be963ffbe0a">OpenPort</a>();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;OPENED: TR3(port:&quot;</span> &lt;&lt; <a class="code" href="ibs_8cpp.html#a0fc8e8a97223a17e76478274643bb540">PORT_TR</a>.c_str() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="class_c_t_r3.html#a0c96690422fcbaa57ad0c43569023b84">ClosePort</a>();</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;CLOSED: TR3(port:&quot;</span> &lt;&lt; <a class="code" href="ibs_8cpp.html#a0fc8e8a97223a17e76478274643bb540">PORT_TR</a>.c_str() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">//終了処理</span></div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#a06c585509be4908cc4b5ee28b9f8cb95">  372</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_t_r3.html#a06c585509be4908cc4b5ee28b9f8cb95">CTR3::Close</a>() {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    close(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;CLOSED: TR3&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#af8cad3d03c19a9ef74159be963ffbe0a">  378</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_t_r3.html#af8cad3d03c19a9ef74159be963ffbe0a">CTR3::OpenPort</a>(){</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <a class="code" href="ibs_8cpp.html#a5a4ea210508f9ed64bb9a43207233cfb">D_COUT</a>(<span class="stringliteral">&quot;opening port : &quot;</span> &lt;&lt; <a class="code" href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a> &lt;&lt; <span class="stringliteral">&quot;   &quot;</span>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keywordflow">if</span> ( (<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a> = open(<a class="code" href="ibs_8cpp.html#a0fc8e8a97223a17e76478274643bb540">PORT_TR</a>.c_str(), (O_RDWR | O_NOCTTY) )) &lt; 0 ) {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;       printf(<span class="stringliteral">&quot;ERROR!!\n&quot;</span>);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;       exit(-1); }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="ibs_8cpp.html#a5a4ea210508f9ed64bb9a43207233cfb">D_COUT</a>(<span class="stringliteral">&quot;\033[1K\r&quot;</span>); </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    tcgetattr(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, &amp;oldtio);         <span class="comment">/* 現在のシリアルポートの設定を待避させる*/</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    memset(&amp;<a class="code" href="class_c_t_r3.html#a15985a0b2c48c7d44edac27950d39d40">newtio</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="class_c_t_r3.html#a15985a0b2c48c7d44edac27950d39d40">newtio</a>));</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="class_c_t_r3.html#a15985a0b2c48c7d44edac27950d39d40">newtio</a>.c_cflag = B38400 | CS8 | CLOCAL | CREAD;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="class_c_t_r3.html#a15985a0b2c48c7d44edac27950d39d40">newtio</a>.c_iflag = IGNPAR | ICRNL;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="class_c_t_r3.html#a15985a0b2c48c7d44edac27950d39d40">newtio</a>.c_oflag = 0;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <a class="code" href="class_c_t_r3.html#a15985a0b2c48c7d44edac27950d39d40">newtio</a>.c_lflag = ICANON;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    tcflush(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, TCIFLUSH);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    tcsetattr(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, TCSANOW, &amp;<a class="code" href="class_c_t_r3.html#a15985a0b2c48c7d44edac27950d39d40">newtio</a>);}</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;</div>
<div class="line"><a name="l00393"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#a0c96690422fcbaa57ad0c43569023b84">  393</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_t_r3.html#a0c96690422fcbaa57ad0c43569023b84">CTR3::ClosePort</a>(){</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    tcsetattr(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, TCSANOW, &amp;oldtio);  <span class="comment">/* 退避させた設定に戻す */</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="ibs_8cpp.html#a5a4ea210508f9ed64bb9a43207233cfb">D_COUT</a>(<span class="stringliteral">&quot;closing port : &quot;</span> &lt;&lt; <a class="code" href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    close(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="ibs_8cpp.html#a5a4ea210508f9ed64bb9a43207233cfb">D_COUT</a>(<span class="stringliteral">&quot;\033[1K\r&quot;</span>); }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">//アンテナの指定</span></div>
<div class="line"><a name="l00401"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#ad76ae24fee078e665d6b4762b21d9098">  401</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_c_t_r3.html#ad76ae24fee078e665d6b4762b21d9098">CTR3::SetAntenna</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> AN) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf[100];</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[2] = 0x4E; <span class="comment">//コマンド</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[3] = 0x02; <span class="comment">//データ長</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[4] = 0x9C; <span class="comment">//コマンド詳細</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[5] = AN; <span class="comment">//アンテナ指定</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    memset(&amp;buf, 0, <span class="keyword">sizeof</span>(buf));</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="class_c_t_r3.html#af8cad3d03c19a9ef74159be963ffbe0a">OpenPort</a>();</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="class_c_t_r3.html#aac759784c783b44b374c9d9a3884e11b">AddChecksum</a>();</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    write(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>, <span class="keyword">sizeof</span>(<a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>));</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    read(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, buf, 9);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span> (buf[2] != <a class="code" href="ibs_8cpp.html#a3a282a5ac1d89f541dc31058c5a3b562">TR3_ACK</a>) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        read(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, buf, 100);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;TR3: SendCommandError -&gt; SetAntenna&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">return</span> -1; }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a> = (int)buf[5];</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="class_c_t_r3.html#a0c96690422fcbaa57ad0c43569023b84">ClosePort</a>();</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)buf[5]; }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">//アンテナの電源ON</span></div>
<div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#ae6aef26696f25ef915c6821b6ada40b0">  424</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_t_r3.html#ae6aef26696f25ef915c6821b6ada40b0">CTR3::AntennaPowerON</a>() {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf[100];</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[2] = 0x4E; <span class="comment">//コマンド</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[3] = 0x02; <span class="comment">//データ長</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[4] = 0x9E; <span class="comment">//コマンド詳細</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[5] = 0x01; <span class="comment">//パワーON</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    memset(&amp;buf, 0, <span class="keyword">sizeof</span>(buf));</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="class_c_t_r3.html#af8cad3d03c19a9ef74159be963ffbe0a">OpenPort</a>();</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="class_c_t_r3.html#aac759784c783b44b374c9d9a3884e11b">AddChecksum</a>();</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    write(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>, <span class="keyword">sizeof</span>(<a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>));</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    read(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, buf, 9);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">if</span> (buf[2] != <a class="code" href="ibs_8cpp.html#a3a282a5ac1d89f541dc31058c5a3b562">TR3_ACK</a>) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        read(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, buf, 100);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;TR3: SendCommandError -&gt; AntennaPowerON&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="class_c_t_r3.html#a0c96690422fcbaa57ad0c43569023b84">ClosePort</a>();</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">//アンテナの電源OFF</span></div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#a890606f65ef7913494ae41c6aabd5fd4">  447</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_t_r3.html#a890606f65ef7913494ae41c6aabd5fd4">CTR3::AntennaPowerOFF</a>() {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">// unsigned long num;</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf[100];</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[2] = 0x4E; <span class="comment">//コマンド</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[3] = 0x02; <span class="comment">//データ長</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[4] = 0x9E; <span class="comment">//コマンド詳細</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[5] = 0x00; <span class="comment">//パワーOFF</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    memset(&amp;buf, 0, <span class="keyword">sizeof</span>(buf));</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="class_c_t_r3.html#af8cad3d03c19a9ef74159be963ffbe0a">OpenPort</a>();</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="class_c_t_r3.html#aac759784c783b44b374c9d9a3884e11b">AddChecksum</a>();</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    write(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>, <span class="keyword">sizeof</span>(<a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>));</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    read(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, buf, 9);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">if</span> ( buf[2] != <a class="code" href="ibs_8cpp.html#a3a282a5ac1d89f541dc31058c5a3b562">TR3_ACK</a> ) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        read(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, buf, 100);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;TR3: SendCommandError -&gt; AntennaPowerOFF&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>; }</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="class_c_t_r3.html#a0c96690422fcbaa57ad0c43569023b84">ClosePort</a>();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">//各アンテナで計測されているタグIDを全て表示</span></div>
<div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#a6fa902a1dcfba84c4d702bbc69253b53">  471</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_t_r3.html#a6fa902a1dcfba84c4d702bbc69253b53">CTR3::PrintTagUIDs</a>() {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="ibs_8cpp.html#a3aedab4e7e4cd23376617272baaf39be">TR3_USED_ANT_NUM</a>; i++) {</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\n:::: ANTENNA &quot;</span> &lt;&lt; i + 1 &lt;&lt; <span class="stringliteral">&quot; ::::&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; (int)<a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[i].size(); j++) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            std::cout &lt;&lt; std::setw(3) &lt;&lt; j + 1 &lt;&lt; <span class="stringliteral">&quot;-&gt; &quot;</span> &lt;&lt; <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[i][j] &lt;&lt; std::endl; } } }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">//タグの読み取り</span></div>
<div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#adbd50e4143b3e344d3d5502043bf2a10">  481</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_c_t_r3.html#adbd50e4143b3e344d3d5502043bf2a10">CTR3::Inventory2</a>() {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">//アンテナを変更しないと既読込のUIDは返さず，新規UIDのみ返す</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> buf[<a class="code" href="ibs_8cpp.html#a399d56edee80f7de024763ff25a9beef">TR3_TAG_SIZE</a> * <a class="code" href="ibs_8cpp.html#ac6ec2b73b68bec0d6052f9acd2f4bdc6">TR3_TAG_MAX</a>];</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[2] = 0x78; <span class="comment">//コマンド</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[3] = 0x03; <span class="comment">//データ長</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[4] = 0xF0; <span class="comment">//コマンド詳細</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[5] = 0x00; <span class="comment">//アンチコリジョン有</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[6] = 0x01; <span class="comment">//出力指定-&gt;取得データ数＋UIDデータ</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="class_c_t_r3.html#af8cad3d03c19a9ef74159be963ffbe0a">OpenPort</a>();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="class_c_t_r3.html#aac759784c783b44b374c9d9a3884e11b">AddChecksum</a>();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    write(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>, <span class="keyword">sizeof</span>(<a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>));</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    read(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, buf, 9);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span> (buf[2] != <a class="code" href="ibs_8cpp.html#a3a282a5ac1d89f541dc31058c5a3b562">TR3_ACK</a>) {</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;TR3: SendCommandError -&gt; Inventory2&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        usleep(100000);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        read(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, buf, <a class="code" href="ibs_8cpp.html#a399d56edee80f7de024763ff25a9beef">TR3_TAG_SIZE</a> * <a class="code" href="ibs_8cpp.html#ac6ec2b73b68bec0d6052f9acd2f4bdc6">TR3_TAG_MAX</a>);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">return</span> -1; }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordtype">int</span> tag_num = (int)buf[5];  <span class="comment">//読み込むタグの数</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="comment">//-------------</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">//タグ情報の読込</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; tag_num; i++) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordtype">char</span> hex[17];</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        read(<a class="code" href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">fd</a>, buf, <a class="code" href="ibs_8cpp.html#a399d56edee80f7de024763ff25a9beef">TR3_TAG_SIZE</a>);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        sprintf(hex, <span class="stringliteral">&quot;%02X%02X%02X%02X%02X%02X%02X%02X&quot;</span>,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                buf[12],    buf[11],    buf[10],    buf[9],</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                buf[8],     buf[7],     buf[6],     buf[5]);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].push_back(std::string(hex));}</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <a class="code" href="class_c_t_r3.html#a0c96690422fcbaa57ad0c43569023b84">ClosePort</a>();</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">return</span> tag_num; }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">//タグの入出のチェック</span></div>
<div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#ab5e4f0b07c3a4bc37891f1de4b9f809d">  518</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_c_t_r3.html#ab5e4f0b07c3a4bc37891f1de4b9f809d">CTR3::GetTagDiff</a>(std::string &amp;diffUID, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> AN) {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="class_c_t_r3.html#ad76ae24fee078e665d6b4762b21d9098">SetAntenna</a>(AN);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="ibs_8cpp.html#a41b904cb066c95952a52cdef18efd703">vec_str</a> preUIDs = <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>];</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].clear();</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_c_t_r3.html#adbd50e4143b3e344d3d5502043bf2a10">Inventory2</a>() == -1) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">//タグの増減の確認</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    std::sort(<a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].begin(), <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].end());</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">// IDにあってpreIDにない =&gt; 追加された物品ID</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="ibs_8cpp.html#a41b904cb066c95952a52cdef18efd703">vec_str</a> increase;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    std::set_difference(<a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].begin(), <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].end(), preUIDs.begin(), preUIDs.end(),</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                        std::inserter(increase, increase.begin()));</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">// preIDにあってIDにない =&gt; 取り除かれた物品ID</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <a class="code" href="ibs_8cpp.html#a41b904cb066c95952a52cdef18efd703">vec_str</a> decrease;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    std::set_difference(preUIDs.begin(), preUIDs.end(), <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].begin(), <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].end(),</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        std::inserter(decrease, decrease.begin()));</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">// 増減なし</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">if</span> ( (increase.size() == 0) &amp;&amp; (decrease.size() == 0) ) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="comment">// 物品追加</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">if</span> ( (increase.size() == 1) &amp;&amp; (decrease.size() == 0) ) {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        diffUID = increase[0];</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        <span class="keywordflow">return</span> 1; }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="comment">// 物品除去</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">if</span> ( (increase.size() == 0) &amp;&amp; (decrease.size() == 1) ) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        diffUID = decrease[0];</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keywordflow">return</span> -1; }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="comment">// 複数物品の同時入出時（１個ずつ検出するようにする）</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">if</span> (increase.size() &gt;= 1) {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        preUIDs.push_back(increase[0]);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>] = preUIDs;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        std::sort(<a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].begin(), <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].end());</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        diffUID = increase[0];</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keywordflow">return</span> 1; }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> (decrease.size() &gt;= 1) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        preUIDs.erase(<span class="keyword">remove</span>(preUIDs.begin(), preUIDs.end(), decrease[0]),  preUIDs.end());</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>] = preUIDs;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        std::sort(<a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].begin(), <a class="code" href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">mUIDs</a>[<a class="code" href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">mActiveAntenna</a>].end());</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        diffUID = decrease[0];</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">return</span> -1; }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">//通信用サブ関数</span></div>
<div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="class_c_t_r3.html#aac759784c783b44b374c9d9a3884e11b">  566</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_c_t_r3.html#aac759784c783b44b374c9d9a3884e11b">CTR3::AddChecksum</a>() {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordtype">int</span> num = (int)<a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[3] + 5;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[num - 1] = <a class="code" href="ibs_8cpp.html#ad99617d68d1009eed07e9da83c1ec14c">TR3_ETX</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[num + 1] = <a class="code" href="ibs_8cpp.html#a10a93622ab558e891f3ace1c3ecd287a">TR3_CR</a>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[num] = 0x00;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num; i++) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[num] += <a class="code" href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">mCommand</a>[i]; }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">return</span> num + 2; }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00579"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html#a7f63e0b50de6dea88308f9d52f2fc726">  579</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_tag_o_b_j.html#a7f63e0b50de6dea88308f9d52f2fc726">CTagOBJ::Setup</a>() {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordtype">char</span> <span class="keywordtype">id</span>[<a class="code" href="ibs_8cpp.html#a02ebfacfe01d06dac0d6a7990be1d6b3">TR3_UID_SIZE</a> * 2 + 1] = {<span class="charliteral">&#39;\0&#39;</span> };</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ibs_8cpp.html#a02ebfacfe01d06dac0d6a7990be1d6b3">TR3_UID_SIZE</a> * 2; i++)</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <span class="keywordtype">id</span>[i] = 0x00;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">mUID</a>.assign(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">LC_MAX_SENSOR_NUM</a>; i++)</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <a class="code" href="class_c_tag_o_b_j.html#a981dc794723b7d840d7a7197cede5b60">mDiffs</a>[i] = 0;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="class_c_tag_o_b_j.html#a72cf7b86cc7a011d924664a4eb1d0c35">mX</a> = <a class="code" href="class_c_tag_o_b_j.html#a863247a8d2fc31ae25e3ff5d035a6c9a">mY</a> = 0;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <a class="code" href="class_c_tag_o_b_j.html#a686315632804b3a7e78414ff68fc4872">mWeight</a> = 0;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="class_c_tag_o_b_j.html#a864b70701ce07ed4a9da0ba61e25f952">mName</a> = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="class_c_tag_o_b_j.html#a48cb35c9dd1d47cc63a149ac18782ddb">mComment</a> = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00593"></a><span class="lineno"><a class="line" href="class_c_tag_o_b_j.html#a253025c5b5603be2af238f3bda5b1bb4">  593</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_tag_o_b_j.html#a253025c5b5603be2af238f3bda5b1bb4">CTagOBJ::Close</a>() {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00597"></a><span class="lineno"><a class="line" href="class_c_stage.html#a3a2ea0f98635ec14875cbbe1ccb5d89e">  597</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_stage.html#a3a2ea0f98635ec14875cbbe1ccb5d89e">CStage::Setup</a>() {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <a class="code" href="class_c_stage.html#a257bbfe84f165ddd017277ae971791de">cLoadCell</a>.<a class="code" href="class_c_load_cell.html#aed02b108d6edd17adc845a0d86fa0871">Setup</a>();</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; i++) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <a class="code" href="class_c_stage.html#ab9c62fdbf228acade7a75788f28f7e17">mStagePos</a>[i] = 0; }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <a class="code" href="class_c_stage.html#ab58408c8c73b0c39c09990acc33c0d9a">mName</a> = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00606"></a><span class="lineno"><a class="line" href="class_c_stage.html#af8bb32d272a922b7f0c1afe8c5bcc57c">  606</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_stage.html#af8bb32d272a922b7f0c1afe8c5bcc57c">CStage::Close</a>() {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="class_c_stage.html#aa772cbfe279e9029f7eb4fbe6fa6689b">  610</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_stage.html#aa772cbfe279e9029f7eb4fbe6fa6689b">CStage::SetSensorPos</a>(<span class="keywordtype">int</span> sensor_num, <span class="keywordtype">float</span> x[], <span class="keywordtype">float</span> y[]) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <a class="code" href="class_c_stage.html#a257bbfe84f165ddd017277ae971791de">cLoadCell</a>.<a class="code" href="class_c_load_cell.html#ab9d1d0beef3b47823788f2350ee4db52">SetSensorPos</a>(sensor_num, x, y); }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00614"></a><span class="lineno"><a class="line" href="class_c_stage.html#aa3430025ec08870ccf3abc0c0d9517c6">  614</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_stage.html#aa3430025ec08870ccf3abc0c0d9517c6">CStage::SetAntenna</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> AN) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <a class="code" href="class_c_stage.html#a1e1bfd7423a2f6a55e3c923b2cc06d4d">mAntenna</a> =  AN; }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00618"></a><span class="lineno"><a class="line" href="class_c_intel_cab.html#a6ef901d93959ac2b4c6ff320863f8d8a">  618</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_intel_cab.html#a6ef901d93959ac2b4c6ff320863f8d8a">CIntelCab::Setup</a>(<span class="keywordtype">int</span> stage_num) {</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    <a class="code" href="class_c_intel_cab.html#a3ead3daadede0387684f1afa68c65148">mStageNum</a> = stage_num;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00623"></a><span class="lineno"><a class="line" href="class_c_intel_cab.html#a5560e4ecb9223b1031e35c3b9b2c5000">  623</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_intel_cab.html#a5560e4ecb9223b1031e35c3b9b2c5000">CIntelCab::Close</a>() {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>; }</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00627"></a><span class="lineno"><a class="line" href="class_c_intel_cab.html#aadc0b97ecc3065d8821657e62055ac08">  627</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_intel_cab.html#aadc0b97ecc3065d8821657e62055ac08">CIntelCab::PrintObjInfo</a>() {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <a class="code" href="class_c_tag_o_b_j.html">CTagOBJ</a>  *cObj;</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_c_intel_cab.html#a3ead3daadede0387684f1afa68c65148">mStageNum</a>; i++) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; std::setw(20) &lt;&lt; std::setfill(<span class="charliteral">&#39;:&#39;</span>) &lt;&lt; <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[i].<a class="code" href="class_c_stage.html#ab58408c8c73b0c39c09990acc33c0d9a">mName</a> &lt;&lt; <span class="stringliteral">&quot;::::::::::&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[i].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.size(); j++) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            cObj = &amp;(<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[i].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>[j]);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            printf(<span class="stringliteral">&quot;%3d:  UID-&gt;&quot;</span>, j + 1);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            std::cout &lt;&lt; cObj-&gt;<a class="code" href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">mUID</a>;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            printf(<span class="stringliteral">&quot;  Weight=%4d  X=%4.0f Y=%4.0f&quot;</span>, cObj-&gt;<a class="code" href="class_c_tag_o_b_j.html#a686315632804b3a7e78414ff68fc4872">mWeight</a>, cObj-&gt;<a class="code" href="class_c_tag_o_b_j.html#a72cf7b86cc7a011d924664a4eb1d0c35">mX</a>, cObj-&gt;<a class="code" href="class_c_tag_o_b_j.html#a863247a8d2fc31ae25e3ff5d035a6c9a">mY</a>);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot; &lt;&quot;</span> &lt;&lt; cObj-&gt;<a class="code" href="class_c_tag_o_b_j.html#a864b70701ce07ed4a9da0ba61e25f952">mName</a> &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; cObj-&gt;<a class="code" href="class_c_tag_o_b_j.html#a48cb35c9dd1d47cc63a149ac18782ddb">mComment</a> &lt;&lt; <span class="stringliteral">&quot;&gt;&quot;</span> &lt;&lt; std::endl; } } }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00640"></a><span class="lineno"><a class="line" href="class_c_intel_cab.html#ac447a91375cc34f3fa40ea5868769904">  640</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="class_c_intel_cab.html#ac447a91375cc34f3fa40ea5868769904">CIntelCab::UpdateObj</a>(<span class="keywordtype">int</span> No, <a class="code" href="class_c_tag_o_b_j.html">CTagOBJ</a>  *cInOut) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keyword">static</span> <a class="code" href="class_c_tag_o_b_j.html">CTagOBJ</a>  cObj, cObjIn[<a class="code" href="ibs_8cpp.html#a280b8ad925f5bb715f19cd118479a9b3">IC_STAGES_MAX</a>], cObjOut[<a class="code" href="ibs_8cpp.html#a280b8ad925f5bb715f19cd118479a9b3">IC_STAGES_MAX</a>];</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">int</span> InOutTag[<a class="code" href="ibs_8cpp.html#a280b8ad925f5bb715f19cd118479a9b3">IC_STAGES_MAX</a>], InOutLC[<a class="code" href="ibs_8cpp.html#a280b8ad925f5bb715f19cd118479a9b3">IC_STAGES_MAX</a>];</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordtype">int</span> value = <a class="code" href="ibs_8cpp.html#ad60e12a8809faaef704ed8cec0be02ac">IC_OBJECT_STAY</a>;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">if</span> (No &gt;= <a class="code" href="class_c_intel_cab.html#a3ead3daadede0387684f1afa68c65148">mStageNum</a>)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ibs_8cpp.html#ad60e12a8809faaef704ed8cec0be02ac">IC_OBJECT_STAY</a>;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="comment">//タグの増減チェック</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="class_c_intel_cab.html#a30dcf7e509a45a3f71bc1ba88ea6e0e3">cTR3</a>.<a class="code" href="class_c_t_r3.html#ae6aef26696f25ef915c6821b6ada40b0">AntennaPowerON</a>();</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_c_intel_cab.html#a3ead3daadede0387684f1afa68c65148">mStageNum</a> == 1) {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <a class="code" href="class_c_intel_cab.html#a30dcf7e509a45a3f71bc1ba88ea6e0e3">cTR3</a>.<a class="code" href="class_c_t_r3.html#ad76ae24fee078e665d6b4762b21d9098">SetAntenna</a>(<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].mAntenna + 1); }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordtype">int</span> inout = <a class="code" href="class_c_intel_cab.html#a30dcf7e509a45a3f71bc1ba88ea6e0e3">cTR3</a>.<a class="code" href="class_c_t_r3.html#ab5e4f0b07c3a4bc37891f1de4b9f809d">GetTagDiff</a>(cObj.<a class="code" href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">mUID</a>, <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#a1e1bfd7423a2f6a55e3c923b2cc06d4d">mAntenna</a>);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <a class="code" href="class_c_intel_cab.html#a30dcf7e509a45a3f71bc1ba88ea6e0e3">cTR3</a>.<a class="code" href="class_c_t_r3.html#a890606f65ef7913494ae41c6aabd5fd4">AntennaPowerOFF</a>();</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">//タグ数増加</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">if</span> (inout &gt; 0) {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        InOutTag[No] = 1;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        cObjIn[No] = cObj; }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="comment">//タグ数減少，出庫</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( inout &lt; 0 ) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.size(); i++) {       <span class="comment">//cStage[No].cTagObjを更新</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].cTagObj.at(i).mUID.compare(cObj.<a class="code" href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">mUID</a>) == 0) {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.erase(<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].cTagObj.begin() + i);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                InOutLC[No] = 0;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        InOutTag[No] = 0;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        *cInOut = cObj;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        value = <a class="code" href="ibs_8cpp.html#ae19a48cb6d01f24569002419c02523ee">IC_OBJECT_OUT</a>; }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="comment">//ロードセルの増減チェック</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    cObj.<a class="code" href="class_c_tag_o_b_j.html#a686315632804b3a7e78414ff68fc4872">mWeight</a> = <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#a257bbfe84f165ddd017277ae971791de">cLoadCell</a>.<a class="code" href="class_c_load_cell.html#a4548e87aa05684bef7ab9b6a6e4f5908">GetWeightDiff</a>(&amp;cObj.<a class="code" href="class_c_tag_o_b_j.html#a72cf7b86cc7a011d924664a4eb1d0c35">mX</a>, &amp;cObj.<a class="code" href="class_c_tag_o_b_j.html#a863247a8d2fc31ae25e3ff5d035a6c9a">mY</a>, cObj.<a class="code" href="class_c_tag_o_b_j.html#a981dc794723b7d840d7a7197cede5b60">mDiffs</a>);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">if</span> ( (cObj.<a class="code" href="class_c_tag_o_b_j.html#a686315632804b3a7e78414ff68fc4872">mWeight</a> &gt; 0) &amp;&amp; (InOutTag[No] &gt; 0) ) {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="comment">//入庫</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        cObj.<a class="code" href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">mUID</a> = cObjIn[No].<a class="code" href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">mUID</a>;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.push_back(cObj);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        InOutTag[No] = 0;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        InOutLC[No]  = 0;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        *cInOut = cObj;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        value = <a class="code" href="ibs_8cpp.html#af1cb23ac4ed0327d752bd7b7cd6fb4d4">IC_OBJECT_IN</a>; }</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( (cObj.<a class="code" href="class_c_tag_o_b_j.html#a686315632804b3a7e78414ff68fc4872">mWeight</a> &gt; 0) &amp;&amp; (InOutLC[No] &lt; 0) ) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="comment">//庫内移動</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordtype">int</span> cnt = <a class="code" href="ibs_8cpp.html#ac6ec2b73b68bec0d6052f9acd2f4bdc6">TR3_TAG_MAX</a>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.size(); i++) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].cTagObj.at(i).mUID.compare(cObjOut[No].mUID) == 0) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                cnt = i;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                <span class="keywordflow">break</span>; } }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keywordflow">if</span> (cnt != <a class="code" href="ibs_8cpp.html#ac6ec2b73b68bec0d6052f9acd2f4bdc6">TR3_TAG_MAX</a>) {</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.at(cnt) = cObj;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.at(cnt).mUID     = cObjOut[No].<a class="code" href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">mUID</a>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.at(cnt).mName    = cObjOut[No].<a class="code" href="class_c_tag_o_b_j.html#a864b70701ce07ed4a9da0ba61e25f952">mName</a>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.at(cnt).mComment = cObjOut[No].<a class="code" href="class_c_tag_o_b_j.html#a48cb35c9dd1d47cc63a149ac18782ddb">mComment</a>;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            InOutLC[No] = 0;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            *cInOut = <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.at(cnt);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            value = <a class="code" href="ibs_8cpp.html#a027355753db6be51cd3fffa9f3f8018a">IC_OBJECT_MOVE</a>; } }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="comment">//タグ無し物品の入庫</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">else</span> {}</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">//持ち上げ</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">if</span> (cObj.<a class="code" href="class_c_tag_o_b_j.html#a686315632804b3a7e78414ff68fc4872">mWeight</a> &lt; 0) {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordtype">int</span> comp = 5000;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordtype">int</span> cnt = <a class="code" href="ibs_8cpp.html#ac6ec2b73b68bec0d6052f9acd2f4bdc6">TR3_TAG_MAX</a>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.size(); i++) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="keywordtype">int</span> sum = 0;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">LC_MAX_SENSOR_NUM</a>; j++) {</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                sum += abs(abs(<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].cTagObj.at(i).mDiffs[j]) - abs(cObj.<a class="code" href="class_c_tag_o_b_j.html#a981dc794723b7d840d7a7197cede5b60">mDiffs</a>[j])); }</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="keywordflow">if</span> (sum &lt; comp) {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                comp = sum;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                cnt = i; } }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">if</span> (cnt != <a class="code" href="ibs_8cpp.html#ac6ec2b73b68bec0d6052f9acd2f4bdc6">TR3_TAG_MAX</a>) {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            cObjOut[No] = <a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[No].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.at(cnt);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            InOutLC[No] = -1; } }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">return</span> value; }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00717"></a><span class="lineno"><a class="line" href="ibs_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">  717</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="ibs_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv) {</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    std::map&lt;std::string, int32_t&gt; rfidValue;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E17F97A&quot;</span>] = 7001;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E180E50&quot;</span>] = 7002;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E180E58&quot;</span>] = 7003;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E180E60&quot;</span>] = 7004;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E180E68&quot;</span>] = 7005;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E180EA0&quot;</span>] = 7006;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E180EA8&quot;</span>] = 7007;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E181C88&quot;</span>] = 7008;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E181C87&quot;</span>] = 7009;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E181C7F&quot;</span>] = 7010;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E181C77&quot;</span>] = 7011;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E181C3F&quot;</span>] = 7012;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E181C37&quot;</span>] = 7013;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E180E47&quot;</span>] = 7014;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E180E3F&quot;</span>] = 7015;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E180E37&quot;</span>] = 7016;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E1805BD&quot;</span>] = 7017;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E180585&quot;</span>] = 7018;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E18057D&quot;</span>] = 7019;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E17EF3F&quot;</span>] = 7020;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E17EF37&quot;</span>] = 7021;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E17EF2F&quot;</span>] = 7022;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E17EF27&quot;</span>] = 7023;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E17EEEF&quot;</span>] = 7024;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    rfidValue[<span class="stringliteral">&quot;E00401004E17EEE7&quot;</span>] = 7025;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <a class="code" href="class_c_intel_cab.html">CIntelCab</a> cIntelCab(1);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordtype">float</span> xpos0[] = {16, 407, 16, 407 }, ypos0[] = {16, 16, 244, 244 }; <span class="comment">// colorbox</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <a class="code" href="class_c_tag_o_b_j.html">CTagOBJ</a>  cObj;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    tms_msg_db::TmsdbStamped  icsmsg;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    tms_msg_db::Tmsdb                 tmpdata;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    int32_t idSensor, idPlace; <span class="comment">// shelf (ics) &gt;&gt; 928_foor &gt;&gt; 928_room</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    ros::init(argc, argv, <span class="stringliteral">&quot;ics&quot;</span>, ros::init_options::AnonymousName);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    ros::NodeHandle n;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    ros::Publisher ics_pub          = n.advertise&lt;tms_msg_db::TmsdbStamped&gt;(<span class="stringliteral">&quot;tms_db_data&quot;</span>, 10);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    ros::NodeHandle nh_param(<span class="stringliteral">&quot;~&quot;</span>);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    nh_param.param&lt;std::string&gt;(<span class="stringliteral">&quot;PORT_TR&quot;</span>, <a class="code" href="ibs_8cpp.html#a0fc8e8a97223a17e76478274643bb540">PORT_TR</a>, <span class="stringliteral">&quot;/dev/ttyUSB0&quot;</span>);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    nh_param.param&lt;std::string&gt;(<span class="stringliteral">&quot;PORT_LC0&quot;</span>, <a class="code" href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a>, <span class="stringliteral">&quot;/dev/ttyACM0&quot;</span>);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    std::cout &lt;&lt; (<span class="stringliteral">&quot;sudo -S chmod a+rw &quot;</span>+PORT_TR+<span class="stringliteral">&quot; &quot;</span>+<a class="code" href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a>).c_str();</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    system((<span class="stringliteral">&quot;sudo -S chmod a+rw &quot;</span>+PORT_TR+<span class="stringliteral">&quot; &quot;</span>+PORT_LC0).c_str());</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">if</span> (! nh_param.getParam(<span class="stringliteral">&quot;idSensor&quot;</span>, idSensor)) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        ROS_ERROR(<span class="stringliteral">&quot;ros param idSensor isn&#39;t exist&quot;</span>);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">if</span> (! nh_param.getParam(<span class="stringliteral">&quot;idPlace&quot;</span>, idPlace)) {</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        ROS_ERROR(<span class="stringliteral">&quot;ros param idPlace isn&#39;t exist&quot;</span>);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="comment">//iniファイルから値を読み込んで各デバイスに接続</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="comment">//RFIDリーダ接続</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    cIntelCab.<a class="code" href="class_c_intel_cab.html#a30dcf7e509a45a3f71bc1ba88ea6e0e3">cTR3</a>.<a class="code" href="class_c_t_r3.html#aad0fa8aaed9250f6244160e846e295ca">Setup</a>();</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    cIntelCab.<a class="code" href="class_c_intel_cab.html#a30dcf7e509a45a3f71bc1ba88ea6e0e3">cTR3</a>.<a class="code" href="class_c_t_r3.html#a890606f65ef7913494ae41c6aabd5fd4">AntennaPowerOFF</a>();</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[0].<a class="code" href="class_c_stage.html#aa3430025ec08870ccf3abc0c0d9517c6">SetAntenna</a>(<a class="code" href="ibs_8cpp.html#a5046db214a2b64c17c55f2faef3d8caf">TR3_ANT1</a>);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[1].<a class="code" href="class_c_stage.html#aa3430025ec08870ccf3abc0c0d9517c6">SetAntenna</a>(<a class="code" href="ibs_8cpp.html#ac3ef5e3754b9a259c7f3f975de350a70">TR3_ANT2</a>);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">//ロードセル接続</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[0].<a class="code" href="class_c_stage.html#a3a2ea0f98635ec14875cbbe1ccb5d89e">Setup</a>();</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[0].<a class="code" href="class_c_stage.html#aa772cbfe279e9029f7eb4fbe6fa6689b">SetSensorPos</a>(4, xpos0, ypos0);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[0].<a class="code" href="class_c_stage.html#ab9c62fdbf228acade7a75788f28f7e17">mStagePos</a>[0] = 0;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[0].<a class="code" href="class_c_stage.html#ab9c62fdbf228acade7a75788f28f7e17">mStagePos</a>[1] = 0;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[0].<a class="code" href="class_c_stage.html#ab9c62fdbf228acade7a75788f28f7e17">mStagePos</a>[2] = 830;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="comment">//初回時の起動は多少時間がかかるためここで一回実行しておく</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; cIntelCab.<a class="code" href="class_c_intel_cab.html#a3ead3daadede0387684f1afa68c65148">mStageNum</a>; i++) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        cIntelCab.<a class="code" href="class_c_intel_cab.html#ac447a91375cc34f3fa40ea5868769904">UpdateObj</a>(i, &amp;cObj); }</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">//計測開始</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordtype">bool</span> change_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordtype">int</span> index = 0;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;\nSTART&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">while</span> (ros::ok()) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <span class="comment">// vector 初期化</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="comment">// 毎回初期化し，庫内にある物品だけ値を更新して送信する</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        ros::Time now = ros::Time::now() + ros::Duration(9 * 60 * 60); <span class="comment">// GMT +9</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <a class="code" href="ibs_8cpp.html#a5a4ea210508f9ed64bb9a43207233cfb">D_COUT</a>( boost::posix_time::to_iso_extended_string(now.toBoost()) &lt;&lt; std::endl);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordflow">if</span> (! nh_param.getParam(<span class="stringliteral">&quot;frame_id&quot;</span>, icsmsg.header.frame_id)) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            ROS_ERROR(<span class="stringliteral">&quot;ros param frame_id isn&#39;t exist&quot;</span>);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        icsmsg.header.stamp     = now;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        icsmsg.tmsdb.clear();</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ibs_8cpp.html#aad394657151ae8a841b6e6831d7e77f2">MAX_OBJECT_NUM</a>; i++) {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            usleep(1000); <span class="comment">//1ms</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            now = ros::Time::now() + ros::Duration(9 * 60 * 60); <span class="comment">// GMT +9</span></div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            tmpdata.time  = boost::posix_time::to_iso_extended_string(now.toBoost());</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            tmpdata.id        = i + 7001; <span class="comment">//物品IDは 7001 から</span></div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            tmpdata.x         = -1.0;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            tmpdata.y         = -1.0;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            tmpdata.z         = -1.0;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            tmpdata.place = idPlace;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            tmpdata.sensor = idSensor;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            tmpdata.state = <a class="code" href="ibs_8cpp.html#a655c84af1b0034986ff56e12e84f983d">NONE</a>; <span class="comment">//知的収納庫内に 0:存在しない, 1:存在する</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            icsmsg.tmsdb.push_back(tmpdata); }</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; cIntelCab.<a class="code" href="class_c_intel_cab.html#a3ead3daadede0387684f1afa68c65148">mStageNum</a>; i++) {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="comment">//増減の確認</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <span class="keywordflow">switch</span> (cIntelCab.<a class="code" href="class_c_intel_cab.html#ac447a91375cc34f3fa40ea5868769904">UpdateObj</a>(i, &amp;cObj)) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="keywordflow">case</span>  <a class="code" href="ibs_8cpp.html#ad60e12a8809faaef704ed8cec0be02ac">IC_OBJECT_STAY</a>:</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                change_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="keywordflow">case</span>  <a class="code" href="ibs_8cpp.html#af1cb23ac4ed0327d752bd7b7cd6fb4d4">IC_OBJECT_IN</a>:</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;\n\n IN : &quot;</span>;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                index = (int)cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[i].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.size() - 1;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[i].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.at(index).mName    = cObj.<a class="code" href="class_c_tag_o_b_j.html#a864b70701ce07ed4a9da0ba61e25f952">mName</a>;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[i].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.at(index).mComment = cObj.<a class="code" href="class_c_tag_o_b_j.html#a48cb35c9dd1d47cc63a149ac18782ddb">mComment</a>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                change_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keywordflow">case</span>  <a class="code" href="ibs_8cpp.html#a027355753db6be51cd3fffa9f3f8018a">IC_OBJECT_MOVE</a>:</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;\n\nMOVE: &quot;</span>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                change_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="ibs_8cpp.html#ae19a48cb6d01f24569002419c02523ee">IC_OBJECT_OUT</a>:</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;\n\n OUT: &quot;</span>;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                change_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                change_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="keywordflow">if</span> (change_flag) {</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                change_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                int32_t vi = 255;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[i].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>.size(); j++) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                    cObj = cIntelCab.<a class="code" href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">cStage</a>[i].<a class="code" href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">cTagObj</a>[j];</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                    vi = rfidValue[cObj.<a class="code" href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">mUID</a>] - 7001;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                    usleep(1000); <span class="comment">//1ms</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                    now = ros::Time::now() + ros::Duration(9 * 60 * 60); <span class="comment">// GMT +9</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    icsmsg.tmsdb[vi].time     = boost::posix_time::to_iso_extended_string(now.toBoost());</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    icsmsg.tmsdb[vi].id         = rfidValue[cObj.<a class="code" href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">mUID</a>];</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                    icsmsg.tmsdb[vi].state  = <a class="code" href="ibs_8cpp.html#ab77d8997b0680e0ffed72a9a1a9c8998">EXIST</a>;                        <span class="comment">//知的収納庫内に 0:存在しない, 1:存在する</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                    icsmsg.tmsdb[vi].x          = cObj.<a class="code" href="class_c_tag_o_b_j.html#a72cf7b86cc7a011d924664a4eb1d0c35">mX</a>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                    icsmsg.tmsdb[vi].y          = cObj.<a class="code" href="class_c_tag_o_b_j.html#a863247a8d2fc31ae25e3ff5d035a6c9a">mY</a>;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                    icsmsg.tmsdb[vi].weight = cObj.<a class="code" href="class_c_tag_o_b_j.html#a686315632804b3a7e78414ff68fc4872">mWeight</a>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                    <span class="comment">// nh_param.param&lt;float&gt;(&quot;z&quot;,icsmsg.tmsdb[vi].z,NULL);</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                    <span class="keywordflow">if</span> (! nh_param.getParam(<span class="stringliteral">&quot;z&quot;</span>, icsmsg.tmsdb[vi].z)) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                        ROS_ERROR(<span class="stringliteral">&quot;ros param z isn&#39;t exist&quot;</span>);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                        <span class="keywordflow">return</span> 0; } }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                cIntelCab.<a class="code" href="class_c_intel_cab.html#aadc0b97ecc3065d8821657e62055ac08">PrintObjInfo</a>();</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                ics_pub.publish(icsmsg); } } }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">// EOF</span></div>
<div class="ttc" id="ibs_8cpp_html_a0fc8e8a97223a17e76478274643bb540"><div class="ttname"><a href="ibs_8cpp.html#a0fc8e8a97223a17e76478274643bb540">PORT_TR</a></div><div class="ttdeci">std::string PORT_TR</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00039">ibs.cpp:39</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a399d56edee80f7de024763ff25a9beef"><div class="ttname"><a href="ibs_8cpp.html#a399d56edee80f7de024763ff25a9beef">TR3_TAG_SIZE</a></div><div class="ttdeci">#define TR3_TAG_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00074">ibs.cpp:74</a></div></div>
<div class="ttc" id="class_c_load_cell_html_ac7dda0d98c1af1df1062a4315c83c0d5"><div class="ttname"><a href="class_c_load_cell.html#ac7dda0d98c1af1df1062a4315c83c0d5">CLoadCell::ResetWeight</a></div><div class="ttdeci">void ResetWeight(int initial[]=NULL, int num=10)</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00284">ibs.cpp:284</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a655c84af1b0034986ff56e12e84f983d"><div class="ttname"><a href="ibs_8cpp.html#a655c84af1b0034986ff56e12e84f983d">NONE</a></div><div class="ttdeci">#define NONE</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00089">ibs.cpp:89</a></div></div>
<div class="ttc" id="class_c_t_r3_html_a980710f4e15ea29acc6c149d6e48f570"><div class="ttname"><a href="class_c_t_r3.html#a980710f4e15ea29acc6c149d6e48f570">CTR3::mActiveAntenna</a></div><div class="ttdeci">int mActiveAntenna</div><div class="ttdoc">真にアクティブなアンテナ．シリアル通信での返り値が代入される． </div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00137">ibs.cpp:137</a></div></div>
<div class="ttc" id="class_c_stage_html_a3a2ea0f98635ec14875cbbe1ccb5d89e"><div class="ttname"><a href="class_c_stage.html#a3a2ea0f98635ec14875cbbe1ccb5d89e">CStage::Setup</a></div><div class="ttdeci">bool Setup()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00597">ibs.cpp:597</a></div></div>
<div class="ttc" id="ibs_8cpp_html_ad60e12a8809faaef704ed8cec0be02ac"><div class="ttname"><a href="ibs_8cpp.html#ad60e12a8809faaef704ed8cec0be02ac">IC_OBJECT_STAY</a></div><div class="ttdeci">#define IC_OBJECT_STAY</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00087">ibs.cpp:87</a></div></div>
<div class="ttc" id="class_c_t_r3_html"><div class="ttname"><a href="class_c_t_r3.html">CTR3</a></div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00129">ibs.cpp:129</a></div></div>
<div class="ttc" id="class_c_intel_cab_html"><div class="ttname"><a href="class_c_intel_cab.html">CIntelCab</a></div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00192">ibs.cpp:192</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html_a253025c5b5603be2af238f3bda5b1bb4"><div class="ttname"><a href="class_c_tag_o_b_j.html#a253025c5b5603be2af238f3bda5b1bb4">CTagOBJ::Close</a></div><div class="ttdeci">bool Close()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00593">ibs.cpp:593</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a6b8656a2cda060e7ebdd0a3f52bd4a4e"><div class="ttname"><a href="ibs_8cpp.html#a6b8656a2cda060e7ebdd0a3f52bd4a4e">TR3_MAX_COMMAND_SIZE</a></div><div class="ttdeci">#define TR3_MAX_COMMAND_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00078">ibs.cpp:78</a></div></div>
<div class="ttc" id="ibs_8cpp_html_ac3ef5e3754b9a259c7f3f975de350a70"><div class="ttname"><a href="ibs_8cpp.html#ac3ef5e3754b9a259c7f3f975de350a70">TR3_ANT2</a></div><div class="ttdeci">#define TR3_ANT2</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00057">ibs.cpp:57</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a027355753db6be51cd3fffa9f3f8018a"><div class="ttname"><a href="ibs_8cpp.html#a027355753db6be51cd3fffa9f3f8018a">IC_OBJECT_MOVE</a></div><div class="ttdeci">#define IC_OBJECT_MOVE</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00086">ibs.cpp:86</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a0439c17ee38de185bd461305f1fb4cb8"><div class="ttname"><a href="class_c_load_cell.html#a0439c17ee38de185bd461305f1fb4cb8">CLoadCell::Close</a></div><div class="ttdeci">bool Close()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00226">ibs.cpp:226</a></div></div>
<div class="ttc" id="class_c_stage_html_a1e1bfd7423a2f6a55e3c923b2cc06d4d"><div class="ttname"><a href="class_c_stage.html#a1e1bfd7423a2f6a55e3c923b2cc06d4d">CStage::mAntenna</a></div><div class="ttdeci">unsigned char mAntenna</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00182">ibs.cpp:182</a></div></div>
<div class="ttc" id="ibs_8cpp_html_ad99617d68d1009eed07e9da83c1ec14c"><div class="ttname"><a href="ibs_8cpp.html#ad99617d68d1009eed07e9da83c1ec14c">TR3_ETX</a></div><div class="ttdeci">#define TR3_ETX</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00050">ibs.cpp:50</a></div></div>
<div class="ttc" id="ibs_8cpp_html_ab77d8997b0680e0ffed72a9a1a9c8998"><div class="ttname"><a href="ibs_8cpp.html#ab77d8997b0680e0ffed72a9a1a9c8998">EXIST</a></div><div class="ttdeci">#define EXIST</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00090">ibs.cpp:90</a></div></div>
<div class="ttc" id="ibs_8cpp_html_ad533b42d0963430c62bdde2bdf42708d"><div class="ttname"><a href="ibs_8cpp.html#ad533b42d0963430c62bdde2bdf42708d">TR3_STX</a></div><div class="ttdeci">#define TR3_STX</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00049">ibs.cpp:49</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html_a48cb35c9dd1d47cc63a149ac18782ddb"><div class="ttname"><a href="class_c_tag_o_b_j.html#a48cb35c9dd1d47cc63a149ac18782ddb">CTagOBJ::mComment</a></div><div class="ttdeci">std::string mComment</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00172">ibs.cpp:172</a></div></div>
<div class="ttc" id="class_c_stage_html_aa3430025ec08870ccf3abc0c0d9517c6"><div class="ttname"><a href="class_c_stage.html#aa3430025ec08870ccf3abc0c0d9517c6">CStage::SetAntenna</a></div><div class="ttdeci">void SetAntenna(unsigned char AN)</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00614">ibs.cpp:614</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a68aad558e42bcfda8a0121b94e7b1eba"><div class="ttname"><a href="class_c_load_cell.html#a68aad558e42bcfda8a0121b94e7b1eba">CLoadCell::mSensorPosX</a></div><div class="ttdeci">float mSensorPosX[LC_MAX_SENSOR_NUM]</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00112">ibs.cpp:112</a></div></div>
<div class="ttc" id="ibs_8cpp_html_aad394657151ae8a841b6e6831d7e77f2"><div class="ttname"><a href="ibs_8cpp.html#aad394657151ae8a841b6e6831d7e77f2">MAX_OBJECT_NUM</a></div><div class="ttdeci">#define MAX_OBJECT_NUM</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00046">ibs.cpp:46</a></div></div>
<div class="ttc" id="class_c_t_r3_html_a87180197012e34c31da7b61e8b7a7be4"><div class="ttname"><a href="class_c_t_r3.html#a87180197012e34c31da7b61e8b7a7be4">CTR3::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00152">ibs.cpp:152</a></div></div>
<div class="ttc" id="class_c_intel_cab_html_a3ead3daadede0387684f1afa68c65148"><div class="ttname"><a href="class_c_intel_cab.html#a3ead3daadede0387684f1afa68c65148">CIntelCab::mStageNum</a></div><div class="ttdeci">int mStageNum</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00204">ibs.cpp:204</a></div></div>
<div class="ttc" id="class_c_t_r3_html_a890606f65ef7913494ae41c6aabd5fd4"><div class="ttname"><a href="class_c_t_r3.html#a890606f65ef7913494ae41c6aabd5fd4">CTR3::AntennaPowerOFF</a></div><div class="ttdeci">bool AntennaPowerOFF()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00447">ibs.cpp:447</a></div></div>
<div class="ttc" id="class_c_load_cell_html_aed02b108d6edd17adc845a0d86fa0871"><div class="ttname"><a href="class_c_load_cell.html#aed02b108d6edd17adc845a0d86fa0871">CLoadCell::Setup</a></div><div class="ttdeci">bool Setup()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00210">ibs.cpp:210</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a57f820ad22350d467e04e17da0c3e8fb"><div class="ttname"><a href="ibs_8cpp.html#a57f820ad22350d467e04e17da0c3e8fb">LC_MAX_SENSOR_NUM</a></div><div class="ttdeci">#define LC_MAX_SENSOR_NUM</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00042">ibs.cpp:42</a></div></div>
<div class="ttc" id="class_c_stage_html_ab58408c8c73b0c39c09990acc33c0d9a"><div class="ttname"><a href="class_c_stage.html#ab58408c8c73b0c39c09990acc33c0d9a">CStage::mName</a></div><div class="ttdeci">std::string mName</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00184">ibs.cpp:184</a></div></div>
<div class="ttc" id="class_c_stage_html_aa772cbfe279e9029f7eb4fbe6fa6689b"><div class="ttname"><a href="class_c_stage.html#aa772cbfe279e9029f7eb4fbe6fa6689b">CStage::SetSensorPos</a></div><div class="ttdeci">void SetSensorPos(int sensor_num, float x[], float y[])</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00610">ibs.cpp:610</a></div></div>
<div class="ttc" id="class_c_stage_html_a0227696f11c44a0ea28c769cdfc90639"><div class="ttname"><a href="class_c_stage.html#a0227696f11c44a0ea28c769cdfc90639">CStage::CStage</a></div><div class="ttdeci">CStage()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00180">ibs.cpp:180</a></div></div>
<div class="ttc" id="ibs_8cpp_html_ac6ec2b73b68bec0d6052f9acd2f4bdc6"><div class="ttname"><a href="ibs_8cpp.html#ac6ec2b73b68bec0d6052f9acd2f4bdc6">TR3_TAG_MAX</a></div><div class="ttdeci">#define TR3_TAG_MAX</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00077">ibs.cpp:77</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a1b3857837a0bf6fd7bfb4944c4ac8c30"><div class="ttname"><a href="class_c_load_cell.html#a1b3857837a0bf6fd7bfb4944c4ac8c30">CLoadCell::ClosePort</a></div><div class="ttdeci">void ClosePort()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00250">ibs.cpp:250</a></div></div>
<div class="ttc" id="class_c_intel_cab_html_a5e11b13e9cdbf691b016f459785c4a03"><div class="ttname"><a href="class_c_intel_cab.html#a5e11b13e9cdbf691b016f459785c4a03">CIntelCab::cStage</a></div><div class="ttdeci">CStage cStage[IC_STAGES_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00203">ibs.cpp:203</a></div></div>
<div class="ttc" id="class_c_stage_html_ab9c62fdbf228acade7a75788f28f7e17"><div class="ttname"><a href="class_c_stage.html#ab9c62fdbf228acade7a75788f28f7e17">CStage::mStagePos</a></div><div class="ttdeci">int mStagePos[3]</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00183">ibs.cpp:183</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a3aa0de7e430ee1e6e7e57007030c75a4"><div class="ttname"><a href="class_c_load_cell.html#a3aa0de7e430ee1e6e7e57007030c75a4">CLoadCell::fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00126">ibs.cpp:126</a></div></div>
<div class="ttc" id="class_c_stage_html_af1c96e984e21f305770ff9b5c9bb074c"><div class="ttname"><a href="class_c_stage.html#af1c96e984e21f305770ff9b5c9bb074c">CStage::cTagObj</a></div><div class="ttdeci">std::vector&lt; CTagOBJ &gt; cTagObj</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00185">ibs.cpp:185</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html_a239a9c11e4163e0b462097b20dc23784"><div class="ttname"><a href="class_c_tag_o_b_j.html#a239a9c11e4163e0b462097b20dc23784">CTagOBJ::~CTagOBJ</a></div><div class="ttdeci">~CTagOBJ()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00163">ibs.cpp:163</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html_a686315632804b3a7e78414ff68fc4872"><div class="ttname"><a href="class_c_tag_o_b_j.html#a686315632804b3a7e78414ff68fc4872">CTagOBJ::mWeight</a></div><div class="ttdeci">int mWeight</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00167">ibs.cpp:167</a></div></div>
<div class="ttc" id="class_c_t_r3_html_a0c96690422fcbaa57ad0c43569023b84"><div class="ttname"><a href="class_c_t_r3.html#a0c96690422fcbaa57ad0c43569023b84">CTR3::ClosePort</a></div><div class="ttdeci">void ClosePort()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00393">ibs.cpp:393</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a2e2118e0560bdca87afd8f9f15a674d0"><div class="ttname"><a href="class_c_load_cell.html#a2e2118e0560bdca87afd8f9f15a674d0">CLoadCell::newtio</a></div><div class="ttdeci">struct termios oldtio newtio</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00107">ibs.cpp:107</a></div></div>
<div class="ttc" id="class_c_t_r3_html_ae2dd0ddf15683ae5e8274ba64b976456"><div class="ttname"><a href="class_c_t_r3.html#ae2dd0ddf15683ae5e8274ba64b976456">CTR3::~CTR3</a></div><div class="ttdeci">~CTR3()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00141">ibs.cpp:141</a></div></div>
<div class="ttc" id="class_c_intel_cab_html_a6ef901d93959ac2b4c6ff320863f8d8a"><div class="ttname"><a href="class_c_intel_cab.html#a6ef901d93959ac2b4c6ff320863f8d8a">CIntelCab::Setup</a></div><div class="ttdeci">bool Setup(int stage_num)</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00618">ibs.cpp:618</a></div></div>
<div class="ttc" id="class_c_t_r3_html_af8cad3d03c19a9ef74159be963ffbe0a"><div class="ttname"><a href="class_c_t_r3.html#af8cad3d03c19a9ef74159be963ffbe0a">CTR3::OpenPort</a></div><div class="ttdeci">void OpenPort()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00378">ibs.cpp:378</a></div></div>
<div class="ttc" id="class_c_intel_cab_html_ac447a91375cc34f3fa40ea5868769904"><div class="ttname"><a href="class_c_intel_cab.html#ac447a91375cc34f3fa40ea5868769904">CIntelCab::UpdateObj</a></div><div class="ttdeci">int UpdateObj(int stageNo, CTagOBJ *cInOut)</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00640">ibs.cpp:640</a></div></div>
<div class="ttc" id="class_c_t_r3_html_a6fa902a1dcfba84c4d702bbc69253b53"><div class="ttname"><a href="class_c_t_r3.html#a6fa902a1dcfba84c4d702bbc69253b53">CTR3::PrintTagUIDs</a></div><div class="ttdeci">void PrintTagUIDs()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00471">ibs.cpp:471</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a10a93622ab558e891f3ace1c3ecd287a"><div class="ttname"><a href="ibs_8cpp.html#a10a93622ab558e891f3ace1c3ecd287a">TR3_CR</a></div><div class="ttdeci">#define TR3_CR</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00051">ibs.cpp:51</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a58a5404e2ec0d122630c14ff5b69696a"><div class="ttname"><a href="class_c_load_cell.html#a58a5404e2ec0d122630c14ff5b69696a">CLoadCell::CLoadCell</a></div><div class="ttdeci">CLoadCell()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00116">ibs.cpp:116</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a2974d37c5af7a2e9636f52cce2030afe"><div class="ttname"><a href="class_c_load_cell.html#a2974d37c5af7a2e9636f52cce2030afe">CLoadCell::~CLoadCell</a></div><div class="ttdeci">~CLoadCell()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00117">ibs.cpp:117</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html"><div class="ttname"><a href="class_c_tag_o_b_j.html">CTagOBJ</a></div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00155">ibs.cpp:155</a></div></div>
<div class="ttc" id="ibs_8cpp_html_af1cb23ac4ed0327d752bd7b7cd6fb4d4"><div class="ttname"><a href="ibs_8cpp.html#af1cb23ac4ed0327d752bd7b7cd6fb4d4">IC_OBJECT_IN</a></div><div class="ttdeci">#define IC_OBJECT_IN</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00084">ibs.cpp:84</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html_a864b70701ce07ed4a9da0ba61e25f952"><div class="ttname"><a href="class_c_tag_o_b_j.html#a864b70701ce07ed4a9da0ba61e25f952">CTagOBJ::mName</a></div><div class="ttdeci">std::string mName</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00171">ibs.cpp:171</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a17f056971822e54aa60a07fb2ec5a9f9"><div class="ttname"><a href="class_c_load_cell.html#a17f056971822e54aa60a07fb2ec5a9f9">CLoadCell::mPreSensorsWeight</a></div><div class="ttdeci">int mPreSensorsWeight[LC_MAX_SENSOR_NUM]</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00111">ibs.cpp:111</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html_a5d16d573544e0d931afbfcb8e8e13e5f"><div class="ttname"><a href="class_c_tag_o_b_j.html#a5d16d573544e0d931afbfcb8e8e13e5f">CTagOBJ::CTagOBJ</a></div><div class="ttdeci">CTagOBJ()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00161">ibs.cpp:161</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a02ebfacfe01d06dac0d6a7990be1d6b3"><div class="ttname"><a href="ibs_8cpp.html#a02ebfacfe01d06dac0d6a7990be1d6b3">TR3_UID_SIZE</a></div><div class="ttdeci">#define TR3_UID_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00073">ibs.cpp:73</a></div></div>
<div class="ttc" id="class_c_t_r3_html_a7f4bd9be7691b2a11ec51dd17200056a"><div class="ttname"><a href="class_c_t_r3.html#a7f4bd9be7691b2a11ec51dd17200056a">CTR3::mUIDs</a></div><div class="ttdeci">vec_str mUIDs[TR3_USED_ANT_NUM]</div><div class="ttdoc">見えているタグのUIDのリスト </div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00142">ibs.cpp:142</a></div></div>
<div class="ttc" id="ibs_8cpp_html_aed2a39405aa5b4659703051182dc0ca4"><div class="ttname"><a href="ibs_8cpp.html#aed2a39405aa5b4659703051182dc0ca4">LC_GET_WEIGHT_CNT</a></div><div class="ttdeci">#define LC_GET_WEIGHT_CNT</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00043">ibs.cpp:43</a></div></div>
<div class="ttc" id="class_c_load_cell_html_ab9d1d0beef3b47823788f2350ee4db52"><div class="ttname"><a href="class_c_load_cell.html#ab9d1d0beef3b47823788f2350ee4db52">CLoadCell::SetSensorPos</a></div><div class="ttdeci">void SetSensorPos(int sensor_num, float x[], float y[])</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00258">ibs.cpp:258</a></div></div>
<div class="ttc" id="class_c_t_r3_html_aba12596e98594fc1c342cbc6adcc9018"><div class="ttname"><a href="class_c_t_r3.html#aba12596e98594fc1c342cbc6adcc9018">CTR3::CTR3</a></div><div class="ttdeci">CTR3()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00140">ibs.cpp:140</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a5046db214a2b64c17c55f2faef3d8caf"><div class="ttname"><a href="ibs_8cpp.html#a5046db214a2b64c17c55f2faef3d8caf">TR3_ANT1</a></div><div class="ttdeci">#define TR3_ANT1</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00056">ibs.cpp:56</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a53fefc315748b958c8366789985490d7"><div class="ttname"><a href="class_c_load_cell.html#a53fefc315748b958c8366789985490d7">CLoadCell::mSensorNum</a></div><div class="ttdeci">int mSensorNum</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00121">ibs.cpp:121</a></div></div>
<div class="ttc" id="class_c_stage_html_af8bb32d272a922b7f0c1afe8c5bcc57c"><div class="ttname"><a href="class_c_stage.html#af8bb32d272a922b7f0c1afe8c5bcc57c">CStage::Close</a></div><div class="ttdeci">bool Close()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00606">ibs.cpp:606</a></div></div>
<div class="ttc" id="class_c_t_r3_html_ae6aef26696f25ef915c6821b6ada40b0"><div class="ttname"><a href="class_c_t_r3.html#ae6aef26696f25ef915c6821b6ada40b0">CTR3::AntennaPowerON</a></div><div class="ttdeci">bool AntennaPowerON()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00424">ibs.cpp:424</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a41b904cb066c95952a52cdef18efd703"><div class="ttname"><a href="ibs_8cpp.html#a41b904cb066c95952a52cdef18efd703">vec_str</a></div><div class="ttdeci">#define vec_str</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00093">ibs.cpp:93</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a280b8ad925f5bb715f19cd118479a9b3"><div class="ttname"><a href="ibs_8cpp.html#a280b8ad925f5bb715f19cd118479a9b3">IC_STAGES_MAX</a></div><div class="ttdeci">#define IC_STAGES_MAX</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00083">ibs.cpp:83</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html_a6a68ea0fa18c87d45f085b9efe8e07f1"><div class="ttname"><a href="class_c_tag_o_b_j.html#a6a68ea0fa18c87d45f085b9efe8e07f1">CTagOBJ::mUID</a></div><div class="ttdeci">std::string mUID</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00164">ibs.cpp:164</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html_a981dc794723b7d840d7a7197cede5b60"><div class="ttname"><a href="class_c_tag_o_b_j.html#a981dc794723b7d840d7a7197cede5b60">CTagOBJ::mDiffs</a></div><div class="ttdeci">int mDiffs[LC_MAX_SENSOR_NUM]</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00168">ibs.cpp:168</a></div></div>
<div class="ttc" id="class_c_intel_cab_html_aadc0b97ecc3065d8821657e62055ac08"><div class="ttname"><a href="class_c_intel_cab.html#aadc0b97ecc3065d8821657e62055ac08">CIntelCab::PrintObjInfo</a></div><div class="ttdeci">void PrintObjInfo()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00627">ibs.cpp:627</a></div></div>
<div class="ttc" id="class_c_t_r3_html_adbd50e4143b3e344d3d5502043bf2a10"><div class="ttname"><a href="class_c_t_r3.html#adbd50e4143b3e344d3d5502043bf2a10">CTR3::Inventory2</a></div><div class="ttdeci">int Inventory2()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00481">ibs.cpp:481</a></div></div>
<div class="ttc" id="class_c_t_r3_html_a4f8b9b680665c560eb2e285cc527fe84"><div class="ttname"><a href="class_c_t_r3.html#a4f8b9b680665c560eb2e285cc527fe84">CTR3::mCommand</a></div><div class="ttdeci">unsigned char mCommand[TR3_MAX_COMMAND_SIZE]</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00135">ibs.cpp:135</a></div></div>
<div class="ttc" id="class_c_stage_html"><div class="ttname"><a href="class_c_stage.html">CStage</a></div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00175">ibs.cpp:175</a></div></div>
<div class="ttc" id="class_c_t_r3_html_aad0fa8aaed9250f6244160e846e295ca"><div class="ttname"><a href="class_c_t_r3.html#aad0fa8aaed9250f6244160e846e295ca">CTR3::Setup</a></div><div class="ttdeci">bool Setup()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00357">ibs.cpp:357</a></div></div>
<div class="ttc" id="class_c_t_r3_html_aac759784c783b44b374c9d9a3884e11b"><div class="ttname"><a href="class_c_t_r3.html#aac759784c783b44b374c9d9a3884e11b">CTR3::AddChecksum</a></div><div class="ttdeci">int AddChecksum()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00566">ibs.cpp:566</a></div></div>
<div class="ttc" id="class_c_t_r3_html_ab5e4f0b07c3a4bc37891f1de4b9f809d"><div class="ttname"><a href="class_c_t_r3.html#ab5e4f0b07c3a4bc37891f1de4b9f809d">CTR3::GetTagDiff</a></div><div class="ttdeci">int GetTagDiff(std::string &amp;diffUID, unsigned char AN)</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00518">ibs.cpp:518</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="ibs_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00717">ibs.cpp:717</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a5a4ea210508f9ed64bb9a43207233cfb"><div class="ttname"><a href="ibs_8cpp.html#a5a4ea210508f9ed64bb9a43207233cfb">D_COUT</a></div><div class="ttdeci">#define D_COUT(x)</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00099">ibs.cpp:99</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a4548e87aa05684bef7ab9b6a6e4f5908"><div class="ttname"><a href="class_c_load_cell.html#a4548e87aa05684bef7ab9b6a6e4f5908">CLoadCell::GetWeightDiff</a></div><div class="ttdeci">int GetWeightDiff(float *x, float *y, int diffs[], int threshold=20)</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00304">ibs.cpp:304</a></div></div>
<div class="ttc" id="class_c_t_r3_html_a15985a0b2c48c7d44edac27950d39d40"><div class="ttname"><a href="class_c_t_r3.html#a15985a0b2c48c7d44edac27950d39d40">CTR3::newtio</a></div><div class="ttdeci">struct termios oldtio newtio</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00131">ibs.cpp:131</a></div></div>
<div class="ttc" id="class_c_load_cell_html_ad6fb880bd0b8752530177b6df9d6094e"><div class="ttname"><a href="class_c_load_cell.html#ad6fb880bd0b8752530177b6df9d6094e">CLoadCell::OpenPort</a></div><div class="ttdeci">void OpenPort()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00232">ibs.cpp:232</a></div></div>
<div class="ttc" id="class_c_intel_cab_html_a43734db8b7e89c0b4c78478ebfd618a1"><div class="ttname"><a href="class_c_intel_cab.html#a43734db8b7e89c0b4c78478ebfd618a1">CIntelCab::~CIntelCab</a></div><div class="ttdeci">~CIntelCab()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00200">ibs.cpp:200</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html_a7f63e0b50de6dea88308f9d52f2fc726"><div class="ttname"><a href="class_c_tag_o_b_j.html#a7f63e0b50de6dea88308f9d52f2fc726">CTagOBJ::Setup</a></div><div class="ttdeci">bool Setup()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00579">ibs.cpp:579</a></div></div>
<div class="ttc" id="ibs_8cpp_html_ae19a48cb6d01f24569002419c02523ee"><div class="ttname"><a href="ibs_8cpp.html#ae19a48cb6d01f24569002419c02523ee">IC_OBJECT_OUT</a></div><div class="ttdeci">#define IC_OBJECT_OUT</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00085">ibs.cpp:85</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html_a72cf7b86cc7a011d924664a4eb1d0c35"><div class="ttname"><a href="class_c_tag_o_b_j.html#a72cf7b86cc7a011d924664a4eb1d0c35">CTagOBJ::mX</a></div><div class="ttdeci">float mX</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00169">ibs.cpp:169</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a3a282a5ac1d89f541dc31058c5a3b562"><div class="ttname"><a href="ibs_8cpp.html#a3a282a5ac1d89f541dc31058c5a3b562">TR3_ACK</a></div><div class="ttdeci">#define TR3_ACK</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00052">ibs.cpp:52</a></div></div>
<div class="ttc" id="class_c_intel_cab_html_ae8ad3b41d4419f203a817148b80bcdf2"><div class="ttname"><a href="class_c_intel_cab.html#ae8ad3b41d4419f203a817148b80bcdf2">CIntelCab::CIntelCab</a></div><div class="ttdeci">CIntelCab(int stage_num=IC_STAGES_MAX)</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00198">ibs.cpp:198</a></div></div>
<div class="ttc" id="class_c_intel_cab_html_a5560e4ecb9223b1031e35c3b9b2c5000"><div class="ttname"><a href="class_c_intel_cab.html#a5560e4ecb9223b1031e35c3b9b2c5000">CIntelCab::Close</a></div><div class="ttdeci">bool Close()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00623">ibs.cpp:623</a></div></div>
<div class="ttc" id="ibs_8cpp_html_ad038bdb9d3de7ba88adbb6fd020a83a0"><div class="ttname"><a href="ibs_8cpp.html#ad038bdb9d3de7ba88adbb6fd020a83a0">PORT_LC0</a></div><div class="ttdeci">std::string PORT_LC0</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00039">ibs.cpp:39</a></div></div>
<div class="ttc" id="class_c_t_r3_html_a06c585509be4908cc4b5ee28b9f8cb95"><div class="ttname"><a href="class_c_t_r3.html#a06c585509be4908cc4b5ee28b9f8cb95">CTR3::Close</a></div><div class="ttdeci">bool Close()</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00372">ibs.cpp:372</a></div></div>
<div class="ttc" id="class_c_stage_html_a257bbfe84f165ddd017277ae971791de"><div class="ttname"><a href="class_c_stage.html#a257bbfe84f165ddd017277ae971791de">CStage::cLoadCell</a></div><div class="ttdeci">CLoadCell cLoadCell</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00180">ibs.cpp:180</a></div></div>
<div class="ttc" id="class_c_tag_o_b_j_html_a863247a8d2fc31ae25e3ff5d035a6c9a"><div class="ttname"><a href="class_c_tag_o_b_j.html#a863247a8d2fc31ae25e3ff5d035a6c9a">CTagOBJ::mY</a></div><div class="ttdeci">float mY</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00170">ibs.cpp:170</a></div></div>
<div class="ttc" id="class_c_t_r3_html_ad76ae24fee078e665d6b4762b21d9098"><div class="ttname"><a href="class_c_t_r3.html#ad76ae24fee078e665d6b4762b21d9098">CTR3::SetAntenna</a></div><div class="ttdeci">int SetAntenna(unsigned char AN=TR3_ANT1)</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00401">ibs.cpp:401</a></div></div>
<div class="ttc" id="class_c_load_cell_html"><div class="ttname"><a href="class_c_load_cell.html">CLoadCell</a></div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00105">ibs.cpp:105</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a2aabc4a9a13f29fba6c0f2f73caaf0ef"><div class="ttname"><a href="class_c_load_cell.html#a2aabc4a9a13f29fba6c0f2f73caaf0ef">CLoadCell::mSensorPosY</a></div><div class="ttdeci">float mSensorPosY[LC_MAX_SENSOR_NUM]</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00113">ibs.cpp:113</a></div></div>
<div class="ttc" id="class_c_intel_cab_html_a30dcf7e509a45a3f71bc1ba88ea6e0e3"><div class="ttname"><a href="class_c_intel_cab.html#a30dcf7e509a45a3f71bc1ba88ea6e0e3">CIntelCab::cTR3</a></div><div class="ttdeci">CTR3 cTR3</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00201">ibs.cpp:201</a></div></div>
<div class="ttc" id="ibs_8cpp_html_af93bee80e57bd99ec2e98ca2f7d3fb6c"><div class="ttname"><a href="ibs_8cpp.html#af93bee80e57bd99ec2e98ca2f7d3fb6c">LC_GET_WEIGHT_STABLE</a></div><div class="ttdeci">#define LC_GET_WEIGHT_STABLE</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00044">ibs.cpp:44</a></div></div>
<div class="ttc" id="class_c_load_cell_html_a33b28a515fc435aee4bc6b121fc479a8"><div class="ttname"><a href="class_c_load_cell.html#a33b28a515fc435aee4bc6b121fc479a8">CLoadCell::GetWeight</a></div><div class="ttdeci">int GetWeight(int sensor_id)</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00266">ibs.cpp:266</a></div></div>
<div class="ttc" id="ibs_8cpp_html_a3aedab4e7e4cd23376617272baaf39be"><div class="ttname"><a href="ibs_8cpp.html#a3aedab4e7e4cd23376617272baaf39be">TR3_USED_ANT_NUM</a></div><div class="ttdeci">#define TR3_USED_ANT_NUM</div><div class="ttdef"><b>Definition:</b> <a href="ibs_8cpp_source.html#l00079">ibs.cpp:79</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Feb 25 2015 17:49:06 for ibs by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
